C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE HAL_NRF
OBJECT MODULE PLACED IN .\hal_nrf.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\..\hal\nrf24l01p\hal_nrf.c LARGE BROWSE INCDIR(..\usb_rx;..\..\compiler\
                    -c51;..\..\hal\nrf24lu1p;..\..\hal\nrf24l01p) DEFINE(MCU_NRF24LU1P) DEBUG OBJECTEXTEND CODE LISTINCLUDE SYMBOLS PRINT(.\h
                    -al_nrf.lst) PREPRINT(.\hal_nrf.i) OBJECT(.\hal_nrf.obj)

line level    source

   1          /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2           *
   3           * The information contained herein is confidential property of Nordic 
   4           * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5           * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6           *
   7           * Licensees are granted free, non-transferable use of the information. NO
   8           * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9           * the file.
  10           *              
  11           * $LastChangedRevision: 5717 $
  12           */
  13          
  14           /** @file
  15            * @brief Implementation of hal_nrf
  16           */
  17          /*lint -t2 */
  18          /*lint -esym( 534, hal_nrf_write_reg ) */
  19          /*lint -esym( 534, hal_nrf_rw ) */
  20          /*lint -e708 */
  21          /*lint -e46 */
  22          
  23          #include <stdint.h>
   1      =1  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =1   * Terms and conditions of usage are described in detail in NORDIC
   5      =1   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *
  11      =1   * $LastChangedRevision: 4726 $
  12      =1   */
  13      =1  
  14      =1  /** @file
  15      =1   * Type definitions for firmware projects developed at Nordic semiconductor.
  16      =1   *
  17      =1   * Standard storage classes in C, such as @c char, @c int, and @c long, ar not always
  18      =1   * interpreted in the same way by the compiler. The types here are defined by their
  19      =1   * bit length and signed/unsigned property, as their name indicate. The correlation
  20      =1   * between the name and properties of the storage class should be true, regardless of
  21      =1   * the compiler being used.
  22      =1   */
  23      =1  
  24      =1  #ifndef __STDINT_H__
  25      =1  #define __STDINT_H__
  26      =1  
  27      =1  #ifdef __C51__
  28      =1  
  29      =1  typedef unsigned char uint8_t;        ///< 8 bit unsigned int
  30      =1  
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 2   

  31      =1  typedef signed char int8_t;          ///< 8 bit signed int
  32      =1  
  33      =1  typedef unsigned int uint16_t;        ///< 16 bit unsigned int
  34      =1  
  35      =1  typedef signed int int16_t;          ///< 16 bit signed int
  36      =1  
  37      =1  typedef unsigned long uint32_t;       ///< 32 bit unsigned int
  38      =1  
  39      =1  typedef signed long int32_t;         ///< 32 bit signed int
  40      =1  
  41      =1  #endif // __C51__
  42      =1  
  43      =1  #ifndef NULL
  44      =1  #define NULL (void*)0
  45      =1  #endif
  46      =1  
  47      =1  #endif // __STDINT_H__
  24          #include <stdbool.h>
   1      =1  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =1   * Terms and conditions of usage are described in detail in NORDIC
   5      =1   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *
  11      =1   * $LastChangedRevision: 4726 $
  12      =1   */
  13      =1  
  14      =1  /** @file
  15      =1   * Type definitions for firmware projects developed at Nordic semiconductor.
  16      =1   *
  17      =1   * Standard storage classes in C, such as @c char, @c int, and @c long, ar not always
  18      =1   * interpreted in the same way by the compiler. The types here are defined by their
  19      =1   * bit length and signed/unsigned property, as their name indicate. The correlation
  20      =1   * between the name and properties of the storage class should be true, regardless of
  21      =1   * the compiler being used.
  22      =1   */
  23      =1  
  24      =1  #ifndef __STDBOOL_H__
  25      =1  #define __STDBOOL_H__
  26      =1  
  27      =1  //lint -strong(B,_Bool)
  28      =1  typedef unsigned char _Bool; ///< Boolean type
  29      =1  
  30      =1  #define bool _Bool
  31      =1  #define true 1
  32      =1  #define false 0
  33      =1  #define __bool_true_false_are_defined 1
  34      =1  
  35      =1  #endif // __STDBOOL_H__
  25          
  26          #include "nordic_common.h"
   1      =1  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is confidential property of Nordic 
   4      =1   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =1   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 3   

   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *              
  11      =1   * $LastChangedRevision: 5756 $
  12      =1   */
  13      =1  
  14      =1  /** @file
  15      =1   * @brief Common defines and macros for firmware developed by Nordic Semiconductor.
  16      =1   *
  17      =1   */
  18      =1  
  19      =1  #ifndef NORDIC_COMMON_H__
  20      =1  #define NORDIC_COMMON_H__
  21      =1  
  22      =1  /** Swaps the upper byte with the lower byte in a 16 bit variable */
  23      =1  //lint -emacro((572),SWAP) // Suppress warning 572 "Excessive shift value"
  24      =1  #define SWAP(x) ((((x)&0xFF)<<8)|(((x)>>8)&0xFF))
  25      =1  
  26      =1  /** The upper 8 bits of a 16 bit value */
  27      =1  #define MSB(a) ((a & 0xFF00) >> 8)
  28      =1  /** The lower 8 bits (of a 16 bit value) */
  29      =1  #define LSB(a) ((a & 0xFF))
  30      =1  
  31      =1  /** Leaves the minimum of the two arguments */
  32      =1  #define MIN(a, b) ((a) < (b) ? (a) : (b))
  33      =1  /** Leaves the maximum of the two arguments */
  34      =1  #define MAX(a, b) ((a) < (b) ? (b) : (a))
  35      =1  
  36      =1  #define BIT_0 0x01 /**< The value of bit 0 */
  37      =1  #define BIT_1 0x02 /**< The value of bit 1 */
  38      =1  #define BIT_2 0x04 /**< The value of bit 2 */
  39      =1  #define BIT_3 0x08 /**< The value of bit 3 */
  40      =1  #define BIT_4 0x10 /**< The value of bit 4 */
  41      =1  #define BIT_5 0x20 /**< The value of bit 5 */
  42      =1  #define BIT_6 0x40 /**< The value of bit 6 */
  43      =1  #define BIT_7 0x80 /**< The value of bit 7 */
  44      =1  #define BIT_8 0x0100 /**< The value of bit 8 */
  45      =1  #define BIT_9 0x0200 /**< The value of bit 9 */
  46      =1  #define BIT_10 0x0400 /**< The value of bit 10 */
  47      =1  #define BIT_11 0x0800 /**< The value of bit 11 */
  48      =1  #define BIT_12 0x1000 /**< The value of bit 12 */
  49      =1  #define BIT_13 0x2000 /**< The value of bit 13 */
  50      =1  #define BIT_14 0x4000 /**< The value of bit 14 */
  51      =1  #define BIT_15 0x8000 /**< The value of bit 15 */
  52      =1  
  53      =1  
  54      =1  #endif // NORDIC_COMMON_H__
  27          #include "hal_nrf.h"
   1      =1  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is confidential property of Nordic 
   4      =1   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =1   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *              
  11      =1   * $LastChangedRevision: 5717 $
  12      =1   */
  13      =1  
  14      =1  /** @file
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 4   

  15      =1   * @brief Interface functions for the on-chip radio transceiver. 
  16      =1   */
  17      =1   
  18      =1  /** @defgroup hal_nrf24l01p_hal_nrf RF tranceiver (hal_nrf)
  19      =1   * @{
  20      =1   * @ingroup hal_nrf24l01p
  21      =1   * 
  22      =1   * This is the nRF24L01+ transceiver used in several Nordic Semiconductor devices.
  23      =1   * The transceiver is set up and controlled via an internal SPI interface on the chip. 
  24      =1   * The HAL for the radio transceiver hides this SPI interface from the programmer.
  25      =1   *
  26      =1   * The nRF24LE1 uses the same 2.4GHz GFSK RF transceiver with embedded protocol engine 
  27      =1   * (Enhanced ShockBurst&tm;) that is found in the nRF24L01+ single chip RF Transceiver.
  28      =1   *
  29      =1   * The RF Transceiver module is configured and operated through the RF transceiver map. 
  30      =1   * This register map is accessed by the MCU through a dedicated on-chip Serial 
  31      =1   * Peripheral interface (SPI) and is available in all power modes of the RF Transceiver 
  32      =1   * module. The register map contains all configuration registers in the RF Transceiver 
  33      =1   * and is accessible in all operation modes of the transceiver. The radio transceiver 
  34      =1   * HAL hides this register map and the usage of the internal SPI.
  35      =1   * 
  36      =1   * This HAL module contains setup functions for configurating the radio; operation functions 
  37      =1   * for controlling the radio when active and for sending and receiving data; and test 
  38      =1   * functions for setting the radio in test modes.
  39      =1   */
  40      =1  
  41      =1  #ifndef HAL_NRF_H__
  42      =1  #define HAL_NRF_H__
  43      =1  
  44      =1  #include <stdint.h>
   1      =2  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =2   * Terms and conditions of usage are described in detail in NORDIC
   5      =2   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
  10      =2   *
  11      =2   * $LastChangedRevision: 4726 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2   * Type definitions for firmware projects developed at Nordic semiconductor.
  16      =2   *
  17      =2   * Standard storage classes in C, such as @c char, @c int, and @c long, ar not always
  18      =2   * interpreted in the same way by the compiler. The types here are defined by their
  19      =2   * bit length and signed/unsigned property, as their name indicate. The correlation
  20      =2   * between the name and properties of the storage class should be true, regardless of
  21      =2   * the compiler being used.
  22      =2   */
  23      =2  
  24      =2  #ifndef __STDINT_H__
           =2 #define __STDINT_H__
           =2 
           =2 #ifdef __C51__
           =2 
           =2 typedef unsigned char uint8_t;        ///< 8 bit unsigned int
           =2 
           =2 typedef signed char int8_t;          ///< 8 bit signed int
           =2 
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 5   

           =2 typedef unsigned int uint16_t;        ///< 16 bit unsigned int
           =2 
           =2 typedef signed int int16_t;          ///< 16 bit signed int
           =2 
           =2 typedef unsigned long uint32_t;       ///< 32 bit unsigned int
           =2 
           =2 typedef signed long int32_t;         ///< 32 bit signed int
           =2 
           =2 #endif // __C51__
           =2 
           =2 #ifndef NULL
           =2 #define NULL (void*)0
           =2 #endif
           =2 
           =2 #endif // __STDINT_H__
  45      =1  #include <stdbool.h>
   1      =2  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =2   * Terms and conditions of usage are described in detail in NORDIC
   5      =2   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
  10      =2   *
  11      =2   * $LastChangedRevision: 4726 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2   * Type definitions for firmware projects developed at Nordic semiconductor.
  16      =2   *
  17      =2   * Standard storage classes in C, such as @c char, @c int, and @c long, ar not always
  18      =2   * interpreted in the same way by the compiler. The types here are defined by their
  19      =2   * bit length and signed/unsigned property, as their name indicate. The correlation
  20      =2   * between the name and properties of the storage class should be true, regardless of
  21      =2   * the compiler being used.
  22      =2   */
  23      =2  
  24      =2  #ifndef __STDBOOL_H__
           =2 #define __STDBOOL_H__
           =2 
           =2 //lint -strong(B,_Bool)
           =2 typedef unsigned char _Bool; ///< Boolean type
           =2 
           =2 #define bool _Bool
           =2 #define true 1
           =2 #define false 0
           =2 #define __bool_true_false_are_defined 1
           =2 
           =2 #endif // __STDBOOL_H__
  46      =1  
  47      =1  #include "hal_nrf_reg.h"
   1      =2  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is confidential property of Nordic 
   4      =2   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =2   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 6   

  10      =2   *              
  11      =2   * $LastChangedRevision: 5717 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2  @brief Register definitions for nRF24L01+
  16      =2  
  17      =2  @details Header file defining register mapping with bit definitions. 
  18      =2  This file is radio-chip dependent, and are included with the hal_nrf.h
  19      =2  
  20      =2  @ingroup hal_nrf24l01p_hal_nrf
  21      =2   */
  22      =2  
  23      =2  #ifndef HAL_NRF_REG_H__
  24      =2  #define HAL_NRF_REG_H__
  25      =2  
  26      =2  /** @name - Instruction Set - */
  27      =2  //@{
  28      =2  /* nRF24L01 Instruction Definitions */
  29      =2  #define W_REGISTER         0x20  /**< Register write command */
  30      =2  #define R_RX_PAYLOAD       0x61  /**< Read RX payload command */
  31      =2  #define W_TX_PAYLOAD       0xA0  /**< Write TX payload command */
  32      =2  #define FLUSH_TX           0xE1  /**< Flush TX register command */
  33      =2  #define FLUSH_RX           0xE2  /**< Flush RX register command */
  34      =2  #define REUSE_TX_PL        0xE3  /**< Reuse TX payload command */
  35      =2  #define ACTIVATE           0x50  /**< Activate features */
  36      =2  #define R_RX_PL_WID        0x60  /**< Read RX payload command */
  37      =2  #define W_ACK_PAYLOAD      0xA8  /**< Write ACK payload command */
  38      =2  #define W_TX_PAYLOAD_NOACK 0xB0  /**< Write ACK payload command */
  39      =2  #define NOP                0xFF  /**< No Operation command, used for reading status register */
  40      =2  //@}
  41      =2  
  42      =2  /** @name  - Register Memory Map - */
  43      =2  //@{
  44      =2  /* nRF24L01 * Register Definitions * */
  45      =2  #define CONFIG        0x00  /**< nRF24L01 config register */
  46      =2  #define EN_AA         0x01  /**< nRF24L01 enable Auto-Acknowledge register */
  47      =2  #define EN_RXADDR     0x02  /**< nRF24L01 enable RX addresses register */
  48      =2  #define SETUP_AW      0x03  /**< nRF24L01 setup of address width register */
  49      =2  #define SETUP_RETR    0x04  /**< nRF24L01 setup of automatic retransmission register */
  50      =2  #define RF_CH         0x05  /**< nRF24L01 RF channel register */
  51      =2  #define RF_SETUP      0x06  /**< nRF24L01 RF setup register */
  52      =2  #define STATUS        0x07  /**< nRF24L01 status register */
  53      =2  #define OBSERVE_TX    0x08  /**< nRF24L01 transmit observe register */
  54      =2  #define CD            0x09  /**< nRF24L01 carrier detect register */
  55      =2  #define RX_ADDR_P0    0x0A  /**< nRF24L01 receive address data pipe0 */
  56      =2  #define RX_ADDR_P1    0x0B  /**< nRF24L01 receive address data pipe1 */
  57      =2  #define RX_ADDR_P2    0x0C  /**< nRF24L01 receive address data pipe2 */
  58      =2  #define RX_ADDR_P3    0x0D  /**< nRF24L01 receive address data pipe3 */
  59      =2  #define RX_ADDR_P4    0x0E  /**< nRF24L01 receive address data pipe4 */
  60      =2  #define RX_ADDR_P5    0x0F  /**< nRF24L01 receive address data pipe5 */
  61      =2  #define TX_ADDR       0x10  /**< nRF24L01 transmit address */
  62      =2  #define RX_PW_P0      0x11  /**< nRF24L01 \# of bytes in rx payload for pipe0 */
  63      =2  #define RX_PW_P1      0x12  /**< nRF24L01 \# of bytes in rx payload for pipe1 */
  64      =2  #define RX_PW_P2      0x13  /**< nRF24L01 \# of bytes in rx payload for pipe2 */
  65      =2  #define RX_PW_P3      0x14  /**< nRF24L01 \# of bytes in rx payload for pipe3 */
  66      =2  #define RX_PW_P4      0x15  /**< nRF24L01 \# of bytes in rx payload for pipe4 */
  67      =2  #define RX_PW_P5      0x16  /**< nRF24L01 \# of bytes in rx payload for pipe5 */
  68      =2  #define FIFO_STATUS   0x17  /**< nRF24L01 FIFO status register */
  69      =2  #define DYNPD         0x1C  /**< nRF24L01 Dynamic payload setup */
  70      =2  #define FEATURE       0x1D  /**< nRF24L01 Exclusive feature setup */
  71      =2  #define AGC_CONFIG    0x1E  /**< nRF24L01+ AGC configuration register */
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 7   

  72      =2  
  73      =2  //@}
  74      =2  
  75      =2  /* nRF24L01 related definitions */
  76      =2  /* Interrupt definitions */
  77      =2  /* Operation mode definitions */
  78      =2  
  79      =2  /** An enum describing the radio's irq sources.
  80      =2   *
  81      =2   */
  82      =2  typedef enum {
  83      =2      HAL_NRF_MAX_RT = 4,     /**< Max retries interrupt */
  84      =2      HAL_NRF_TX_DS,          /**< TX data sent interrupt */
  85      =2      HAL_NRF_RX_DR           /**< RX data received interrupt */
  86      =2  } hal_nrf_irq_source_t;
  87      =2  
  88      =2  /* Operation mode definitions */
  89      =2  /** An enum describing the radio's power mode.
  90      =2   *
  91      =2   */
  92      =2  typedef enum {
  93      =2      HAL_NRF_PTX,            /**< Primary TX operation */
  94      =2      HAL_NRF_PRX             /**< Primary RX operation */
  95      =2  } hal_nrf_operation_mode_t;
  96      =2  
  97      =2  /** An enum describing the radio's power mode.
  98      =2   *
  99      =2   */
 100      =2  typedef enum {
 101      =2      HAL_NRF_PWR_DOWN,       /**< Device power-down */
 102      =2      HAL_NRF_PWR_UP          /**< Device power-up */
 103      =2  } hal_nrf_pwr_mode_t;
 104      =2  
 105      =2  /** An enum describing the radio's output power mode's.
 106      =2   *
 107      =2   */
 108      =2  typedef enum {
 109      =2      HAL_NRF_18DBM,          /**< Output power set to -18dBm */
 110      =2      HAL_NRF_12DBM,          /**< Output power set to -12dBm */
 111      =2      HAL_NRF_6DBM,           /**< Output power set to -6dBm  */
 112      =2      HAL_NRF_0DBM            /**< Output power set to 0dBm   */
 113      =2  } hal_nrf_output_power_t;
 114      =2  
 115      =2  /** An enum describing the radio's on-air datarate.
 116      =2   *
 117      =2   */
 118      =2  typedef enum {
 119      =2      HAL_NRF_1MBPS,          /**< Datarate set to 1 Mbps  */
 120      =2      HAL_NRF_2MBPS,          /**< Datarate set to 2 Mbps  */
 121      =2      HAL_NRF_250KBPS         /**< Datarate set to 250 kbps*/
 122      =2  } hal_nrf_datarate_t;
 123      =2  
 124      =2  /** An enum describing the radio's CRC mode.
 125      =2   *
 126      =2   */
 127      =2  typedef enum {
 128      =2      HAL_NRF_CRC_OFF,    /**< CRC check disabled */
 129      =2      HAL_NRF_CRC_8BIT,   /**< CRC check set to 8-bit */
 130      =2      HAL_NRF_CRC_16BIT   /**< CRC check set to 16-bit */
 131      =2  } hal_nrf_crc_mode_t;
 132      =2  
 133      =2  /** An enum describing the read/write payload command.
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 8   

 134      =2   *
 135      =2   */
 136      =2  typedef enum {
 137      =2      HAL_NRF_TX_PLOAD = 7,   /**< TX payload definition */
 138      =2      HAL_NRF_RX_PLOAD,        /**< RX payload definition */
 139      =2      HAL_NRF_ACK_PLOAD
 140      =2  } hal_nrf_pload_command_t;
 141      =2  
 142      =2  /** Structure containing the radio's address map.
 143      =2   * Pipe0 contains 5 unique address bytes,
 144      =2   * while pipe[1..5] share the 4 MSB bytes, set in pipe1.
 145      =2   * <p><b> - Remember that the LSB byte for all pipes have to be unique! -</b>
 146      =2   */
 147      =2  // nRF24L01 Address struct
 148      =2  
 149      =2  
 150      =2  //typedef struct {
 151      =2  //   uint8_t p0[5];            /**< Pipe0 address, 5 bytes */
 152      =2  //    uint8_t p1[5];            /**< Pipe1 address, 5 bytes, 4 MSB bytes shared for pipe1 to pipe5 */
 153      =2  //    uint8_t p2[1];            /**< Pipe2 address, 1 byte */
 154      =2  //    uint8_t p3[1];            /**< Pipe3 address, 1 byte */
 155      =2  //   uint8_t p4[1];            /**< Pipe3 address, 1 byte */
 156      =2  //   uint8_t p5[1];            /**< Pipe3 address, 1 byte */
 157      =2  //   uint8_t tx[5];            /**< TX address, 5 byte */
 158      =2  //} hal_nrf_l01_addr_map;
 159      =2  
 160      =2  
 161      =2  /** An enum describing the nRF24L01 pipe addresses and TX address.
 162      =2   *
 163      =2   */
 164      =2  typedef enum {
 165      =2      HAL_NRF_PIPE0,              /**< Select pipe0 */
 166      =2      HAL_NRF_PIPE1,              /**< Select pipe1 */
 167      =2      HAL_NRF_PIPE2,              /**< Select pipe2 */
 168      =2      HAL_NRF_PIPE3,              /**< Select pipe3 */
 169      =2      HAL_NRF_PIPE4,              /**< Select pipe4 */
 170      =2      HAL_NRF_PIPE5,              /**< Select pipe5 */
 171      =2      HAL_NRF_TX,                 /**< Refer to TX address*/
 172      =2      HAL_NRF_ALL = 0xFF          /**< Close or open all pipes*/
 173      =2                                  /**< @see hal_nrf_set_address @see hal_nrf_get_address
 174      =2                                   @see hal_nrf_open_pipe  @see hal_nrf_close_pipe */
 175      =2  } hal_nrf_address_t;
 176      =2  
 177      =2  /** An enum describing the radio's address width.
 178      =2   *
 179      =2   */
 180      =2  typedef enum {
 181      =2      HAL_NRF_AW_3BYTES = 3,      /**< Set address width to 3 bytes */
 182      =2      HAL_NRF_AW_4BYTES,          /**< Set address width to 4 bytes */
 183      =2      HAL_NRF_AW_5BYTES           /**< Set address width to 5 bytes */
 184      =2  } hal_nrf_address_width_t;
 185      =2  
 186      =2  
 187      =2  /** @name CONFIG register bit definitions */
 188      =2  //@{
 189      =2  
 190      =2  #define MASK_RX_DR    6     /**< CONFIG register bit 6 */
 191      =2  #define MASK_TX_DS    5     /**< CONFIG register bit 5 */
 192      =2  #define MASK_MAX_RT   4     /**< CONFIG register bit 4 */
 193      =2  #define EN_CRC        3     /**< CONFIG register bit 3 */
 194      =2  #define CRCO          2     /**< CONFIG register bit 2 */
 195      =2  #define PWR_UP        1     /**< CONFIG register bit 1 */
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 9   

 196      =2  #define PRIM_RX       0     /**< CONFIG register bit 0 */
 197      =2  //@}
 198      =2  
 199      =2  /** @name RF_SETUP register bit definitions */
 200      =2  //@{
 201      =2  #define PLL_LOCK      4     /**< RF_SETUP register bit 4 */
 202      =2  #define RF_DR         3     /**< RF_SETUP register bit 3 */
 203      =2  #define RF_PWR1       2     /**< RF_SETUP register bit 2 */
 204      =2  #define RF_PWR0       1     /**< RF_SETUP register bit 1 */
 205      =2  #define LNA_HCURR     0     /**< RF_SETUP register bit 0 */
 206      =2  //@}
 207      =2  
 208      =2  /* STATUS 0x07 */
 209      =2  /** @name STATUS register bit definitions */
 210      =2  //@{
 211      =2  #define RX_DR         6     /**< STATUS register bit 6 */
 212      =2  #define TX_DS         5     /**< STATUS register bit 5 */
 213      =2  #define MAX_RT        4     /**< STATUS register bit 4 */
 214      =2  #define TX_FULL       0     /**< STATUS register bit 0 */
 215      =2  //@}
 216      =2  
 217      =2  /* FIFO_STATUS 0x17 */
 218      =2  /** @name FIFO_STATUS register bit definitions */
 219      =2  //@{
 220      =2  #define TX_REUSE      6     /**< FIFO_STATUS register bit 6 */
 221      =2  #define TX_FIFO_FULL  5     /**< FIFO_STATUS register bit 5 */
 222      =2  #define TX_EMPTY      4     /**< FIFO_STATUS register bit 4 */
 223      =2  #define RX_FULL       1     /**< FIFO_STATUS register bit 1 */
 224      =2  #define RX_EMPTY      0     /**< FIFO_STATUS register bit 0 */
 225      =2  //@}
 226      =2  
 227      =2  #endif // HAL_NRF_REG_H__
 228      =2  /** @} */
  48      =1  #include "hal_nrf_hw.h"
   1      =2  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is confidential property of Nordic 
   4      =2   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =2   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
  10      =2   *              
  11      =2   * $LastChangedRevision: 5717 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2  * @brief hal_nrf macros for nRF24LU1+
  16      =2   *
  17      =2   * @defgroup hal_nrf24lu1p_hal_nrf_hw hal_nrf_hw
  18      =2   * @{
  19      =2   * @ingroup hal_nrf24lu1p
  20      =2   *
  21      =2   */
  22      =2  
  23      =2  #ifndef HAL_NRF_LU1_H__
  24      =2  #define HAL_NRF_LU1_H__
  25      =2  
  26      =2  #include <Nordic\reg24lu1.h>
   1      =3  /*--------------------------------------------------------------------------
   2      =3   * reg24lu1.h
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 10  

   3      =3   *
   4      =3   * Keil C51 header file for the Nordic Semiconductor nRF24LU1 2.4GHz RF
   5      =3   * transceiver with embedded 8051 compatible microcontroller and USB.
   6      =3   *
   7      =3   *
   8      =3   *------------------------------------------------------------------------*/
   9      =3  #ifndef __REG24LU1_H__
  10      =3  #define __REG24LU1_H__
  11      =3  
  12      =3  //-----------------------------------------------------------------------------
  13      =3  // Byte Registers
  14      =3  //-----------------------------------------------------------------------------
  15      =3  
  16      =3  sfr   P0           = 0x80;
  17      =3  sfr   SP           = 0x81;
  18      =3  sfr   DPL          = 0x82;
  19      =3  sfr   DPH          = 0x83;
  20      =3  sfr   DPL1         = 0x84;
  21      =3  sfr   DPH1         = 0x85;
  22      =3  sfr   PCON         = 0x87;
  23      =3  sfr   TCON         = 0x88;
  24      =3  sfr   TMOD         = 0x89;
  25      =3  sfr   TL0          = 0x8A;
  26      =3  sfr   TL1          = 0x8B;
  27      =3  sfr   TH0          = 0x8C;
  28      =3  sfr   TH1          = 0x8D;
  29      =3  sfr   CKCON        = 0x8E;
  30      =3  sfr   RFCON        = 0x90;
  31      =3  sfr   DPS          = 0x92;
  32      =3  sfr   P0DIR        = 0x94;
  33      =3  sfr   P0ALT        = 0x95;
  34      =3  sfr   S0CON        = 0x98;
  35      =3  sfr   S0BUF        = 0x99;
  36      =3  sfr   IEN2         = 0x9A;
  37      =3  sfr   USBCON       = 0xA0;
  38      =3  sfr   CLKCTL       = 0xA3;
  39      =3  sfr   PWRDWN       = 0xA4;
  40      =3  sfr   WUCONF       = 0xA5;
  41      =3  sfr   INTEXP       = 0xA6;
  42      =3  sfr   IEN0         = 0xA8;
  43      =3  sfr   IP0          = 0xA9;
  44      =3  sfr   S0RELL       = 0xAA;
  45      =3  sfr   REGXH        = 0xAB;
  46      =3  sfr   REGXL        = 0xAC;
  47      =3  sfr   REGXC        = 0xAD;
  48      =3  sfr   RSTRES       = 0xB1;
  49      =3  sfr   SMDAT        = 0xB2;
  50      =3  sfr   SMCTL        = 0xB3;
  51      =3  sfr   TICKDV       = 0xB5;
  52      =3  sfr   IEN1         = 0xB8;
  53      =3  sfr   IP1          = 0xB9;
  54      =3  sfr   S0RELH       = 0xBA;
  55      =3  sfr   SSCONF       = 0xBC;
  56      =3  sfr   SSDATA       = 0xBD;
  57      =3  sfr   SSSTAT       = 0xBE;
  58      =3  sfr   IRCON        = 0xC0;
  59      =3  sfr   CCEN         = 0xC1;
  60      =3  sfr   CCL1         = 0xC2;
  61      =3  sfr   CCH1         = 0xC3;
  62      =3  sfr   CCL2         = 0xC4;
  63      =3  sfr   CCH2         = 0xC5;
  64      =3  sfr   CCL3         = 0xC6;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 11  

  65      =3  sfr   CCH3         = 0xC7;
  66      =3  sfr   T2CON        = 0xC8;
  67      =3  sfr   P0EXP        = 0xC9;
  68      =3  sfr   CRCL         = 0xCA;
  69      =3  sfr   CRCH         = 0xCB;
  70      =3  sfr   TL2          = 0xCC;
  71      =3  sfr   TH2          = 0xCD;
  72      =3  sfr   PSW          = 0xD0;
  73      =3  sfr   WDCON        = 0xD8;
  74      =3  sfr   USBSLP       = 0xD9;
  75      =3  sfr   ACC          = 0xE0;
  76      =3  sfr   RFDAT        = 0xE5;
  77      =3  sfr   RFCTL        = 0xE6;
  78      =3  sfr   AESCS        = 0xE8;
  79      =3  sfr   MD0          = 0xE9;
  80      =3  sfr   MD1          = 0xEA;
  81      =3  sfr   MD2          = 0xEB;
  82      =3  sfr   MD3          = 0xEC;
  83      =3  sfr   MD4          = 0xED;
  84      =3  sfr   MD5          = 0xEE;
  85      =3  sfr   ARCON        = 0xEF;
  86      =3  sfr   B            = 0xF0;
  87      =3  sfr   AESKIN       = 0xF1;
  88      =3  sfr   AESIV        = 0xF2;
  89      =3  sfr   AESD         = 0xF3;
  90      =3  sfr   AESIA1       = 0xF5;
  91      =3  sfr   AESIA2       = 0xF6;
  92      =3  sfr   FSR          = 0xF8;
  93      =3  sfr   FPCR         = 0xF9;
  94      =3  sfr   FCR          = 0xFA;
  95      =3  
  96      =3  //-----------------------------------------------------------------------------
  97      =3  // Word Registers
  98      =3  //-----------------------------------------------------------------------------
  99      =3  
 100      =3  sfr16 CC1          = 0xC2;
 101      =3  sfr16 CC2          = 0xC4;
 102      =3  sfr16 CC3          = 0xC6;
 103      =3  sfr16 CRC          = 0xCA;
 104      =3  sfr16 T2           = 0xCC;
 105      =3  
 106      =3  //-----------------------------------------------------------------------------
 107      =3  /* Lint uses a trick (see co-kc51.lnt) where sbit gets treated like (expanded to) a bool.
 108      =3     This causes errors due to the strong type checking of _Bool (and thereby bool) that
 109      =3     is turned on in our implementation of stdbool.h.
 110      =3     Therefore, we suppress Lint warning 18 ("Redeclaration") for the sbit-s declared in this file.
 111      =3  */
 112      =3  
 113      =3  /*lint -e18 */
 114      =3  //-----------------------------------------------------------------------------
 115      =3  
 116      =3  //-----------------------------------------------------------------------------
 117      =3  // Bit Definitions
 118      =3  //-----------------------------------------------------------------------------
 119      =3  
 120      =3  /*  FSR  */
 121      =3  sbit  MCDIS        = FSR^7;
 122      =3  sbit  STP          = FSR^6;
 123      =3  sbit  WEN          = FSR^5;
 124      =3  sbit  RDYN         = FSR^4;
 125      =3  sbit  INFEN        = FSR^3;
 126      =3  sbit  RDIS         = FSR^2;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 12  

 127      =3  sbit  RDEND        = FSR^1;
 128      =3  sbit  WPEN         = FSR^0;
 129      =3  
 130      =3  /*  PSW   */
 131      =3  sbit  CY           = PSW^7;
 132      =3  sbit  AC           = PSW^6;
 133      =3  sbit  F0           = PSW^5;
 134      =3  sbit  RS1          = PSW^4;
 135      =3  sbit  RS0          = PSW^3;
 136      =3  sbit  OV           = PSW^2;
 137      =3  sbit  F1           = PSW^1;
 138      =3  sbit  P            = PSW^0;
 139      =3  
 140      =3  /*  TCON  */
 141      =3  sbit  TF1          = TCON^7;
 142      =3  sbit  TR1          = TCON^6;
 143      =3  sbit  TF0          = TCON^5;
 144      =3  sbit  TR0          = TCON^4;
 145      =3  sbit  IE1          = TCON^3;
 146      =3  sbit  IT1          = TCON^2;
 147      =3  sbit  IE0          = TCON^1;
 148      =3  sbit  IT0          = TCON^0;
 149      =3  
 150      =3  /*  S0CON  */
 151      =3  sbit  SM0          = S0CON^7;
 152      =3  sbit  SM1          = S0CON^6;
 153      =3  sbit  SM20         = S0CON^5;
 154      =3  sbit  REN0         = S0CON^4;
 155      =3  sbit  TB80         = S0CON^3;
 156      =3  sbit  RB80         = S0CON^2;
 157      =3  sbit  TI0          = S0CON^1;
 158      =3  sbit  RI0          = S0CON^0;
 159      =3  
 160      =3  /*  T2CON  */
 161      =3  sbit  T2PS         = T2CON^7;
 162      =3  sbit  I3FR         = T2CON^6;
 163      =3  sbit  I2FR         = T2CON^5;
 164      =3  sbit  T2R1         = T2CON^4;
 165      =3  sbit  T2R0         = T2CON^3;
 166      =3  sbit  T2CM         = T2CON^2;
 167      =3  sbit  T2I1         = T2CON^1;
 168      =3  sbit  T2I0         = T2CON^0;
 169      =3  
 170      =3  /*  IEN0  */
 171      =3  sbit  EA           = IEN0^7;
 172      =3  
 173      =3  sbit  ET2          = IEN0^5;
 174      =3  sbit  ES0          = IEN0^4;
 175      =3  sbit  ET1          = IEN0^3;
 176      =3  sbit  EX1          = IEN0^2;
 177      =3  sbit  ET0          = IEN0^1;
 178      =3  sbit  EX0          = IEN0^0;
 179      =3  
 180      =3  /* IEN1  */
 181      =3  sbit  EXEN2        = IEN1^7;
 182      =3  
 183      =3  sbit  WUIRQ        = IEN1^5;
 184      =3  sbit  USB          = IEN1^4;
 185      =3  sbit  USBWU        = IEN1^3;
 186      =3  sbit  SPI          = IEN1^2;
 187      =3  sbit  RF           = IEN1^1;
 188      =3  sbit  RFSPI        = IEN1^0;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 13  

 189      =3  
 190      =3  /* IRCON */
 191      =3  sbit  EXF2         = IRCON^7;
 192      =3  sbit  TF2          = IRCON^6;
 193      =3  sbit  WUF          = IRCON^5;
 194      =3  sbit  USBF         = IRCON^4;
 195      =3  sbit  USBWUF       = IRCON^3;
 196      =3  sbit  SPIF         = IRCON^2;
 197      =3  sbit  RFF          = IRCON^1;
 198      =3  sbit  RFSPIF       = IRCON^0;
 199      =3  
 200      =3  /* USBCON */
 201      =3  sbit  SWRST        = USBCON^7;
 202      =3  sbit  WU           = USBCON^6;
 203      =3  sbit  SUSPEND      = USBCON^5;
 204      =3  sbit  IV4          = USBCON^4;
 205      =3  sbit  IV3          = USBCON^3;
 206      =3  sbit  IV2          = USBCON^2;
 207      =3  sbit  IV1          = USBCON^1;
 208      =3  sbit  IV0          = USBCON^0;
 209      =3  
 210      =3  /* PORT0 */
 211      =3  sbit  P00          = P0^0;
 212      =3  sbit  P01          = P0^1;
 213      =3  sbit  P02          = P0^2;
 214      =3  sbit  P03          = P0^3;
 215      =3  sbit  MCSN         = P0^3;
 216      =3  sbit  SCSN         = P0^3;
 217      =3  sbit  P04          = P0^4;
 218      =3  sbit  P05          = P0^5;
 219      =3  
 220      =3  /* RFCON */
 221      =3  sbit  RFCE         = RFCON^0;
 222      =3  sbit  RFCSN        = RFCON^1;
 223      =3  sbit  RFCKEN       = RFCON^2;
 224      =3  
 225      =3  /* WDCON */
 226      =3  sbit  BD           = WDCON^7;
 227      =3  
 228      =3  /* AESCS */
 229      =3  sbit  GO           = AESCS^0;
 230      =3  sbit  DECR         = AESCS^1;
 231      =3  
 232      =3  /*lint +e18 */  /* Re-enable Lint warning 18 */
 233      =3  
 234      =3  
 235      =3  /* REGX commands */
 236      =3  #define RWD         0x00
 237      =3  #define WWD         0x08
 238      =3  #define RGTIMER     0x01
 239      =3  #define WGTIMER     0x09
 240      =3  #define RRTCLAT     0x02
 241      =3  #define WRTCLAT     0x0A
 242      =3  #define RRTC        0x03
 243      =3  #define WRTCDIS     0x0B
 244      =3  #define RWSTA0      0x04
 245      =3  #define WWCON0      0x0C
 246      =3  #define RWSTA1      0x05
 247      =3  #define WWCON1      0x0D
 248      =3  
 249      =3  //-----------------------------------------------------------------------------
 250      =3  // Interrupt Vector Definitions
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 14  

 251      =3  //-----------------------------------------------------------------------------
 252      =3  
 253      =3  #define INTERRUPT_EXT_INT0     0   // External Interrupt0 (P0.3)
 254      =3  #define INTERRUPT_T0           1   // Timer0 Overflow
 255      =3  #define INTERRUPT_AES_RDY      2   // AES ready interrupt
 256      =3  #define INTERRUPT_T1           3   // Timer1 Overflow
 257      =3  #define INTERRUPT_UART0        4   // UART0, Receive & Transmitt interrupt
 258      =3  #define INTERRUPT_T2           5   // Timer2 Overflow
 259      =3  #define INTERRUPT_RF_RDY       8   // RF SPI ready interrupt
 260      =3  #define INTERRUPT_RFIRQ        9   // RF interrupt
 261      =3  #define INTERRUPT_SPI          10  // SPI interrupt
 262      =3  #define INTERRUPT_USB_WU       11  // USB wakeup interrupt
 263      =3  #define INTERRUPT_USB_INT      12  // USB interrupt
 264      =3  #define INTERRUPT_WU           13  // Internal wakeup interrupt
 265      =3  
 266      =3  //-----------------------------------------------------------------------------
 267      =3  // Header File Preprocessor Directive
 268      =3  //-----------------------------------------------------------------------------
 269      =3  
 270      =3  #endif
  27      =2  
  28      =2  /** Macro that set radio's CSN line LOW.
  29      =2   *
  30      =2   */
  31      =2  #define CSN_LOW() do { RFCSN = 0; } while(0)
  32      =2  
  33      =2  /** Macro that set radio's CSN line HIGH.
  34      =2   *
  35      =2   */
  36      =2  #define CSN_HIGH() do { RFCSN = 1; } while(0)
  37      =2  
  38      =2  /** Macro that set radio's CE line LOW.
  39      =2   *
  40      =2   */
  41      =2  #define CE_LOW() do { RFCE = 0; } while(0)
  42      =2  
  43      =2  /** Macro that set radio's CE line HIGH.
  44      =2   *
  45      =2   */
  46      =2  #define CE_HIGH() do { RFCE = 1; } while(0)
  47      =2  
  48      =2  /** Macro for writing the radio SPI data register.
  49      =2   *
  50      =2   */
  51      =2  #define HAL_NRF_HW_SPI_WRITE(d) do{RFDAT = d; RFSPIF = 0;} while(0)
  52      =2  
  53      =2  /** Macro for reading the radio SPI data register.
  54      =2   *
  55      =2   */
  56      =2  #define HAL_NRF_HW_SPI_READ() RFDAT
  57      =2    
  58      =2  /** Macro specifyng the radio SPI busy flag.
  59      =2   *
  60      =2   */
  61      =2  #define HAL_NRF_HW_SPI_BUSY (!RFSPIF)
  62      =2  
  63      =2  /**
  64      =2   * Pulses the CE to nRF24L01 for at least 10 us
  65      =2   */
  66      =2  #define CE_PULSE() do { \
  67      =2    uint8_t count; \
  68      =2    count = 20; \
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 15  

  69      =2    CE_HIGH();  \
  70      =2    while(count--) \
  71      =2      ; \
  72      =2    CE_LOW();  \
  73      =2    } while(0)
  74      =2  
  75      =2  
  76      =2  #endif // HAL_NRF_LU1_H__
  77      =2  
  78      =2  /** @} */
  49      =1  
  50      =1  
  51      =1  uint8_t hal_nrf_write_reg(uint8_t data reg, uint8_t data value);
  52      =1  /** @name Setup */
  53      =1  //@{
  54      =1  /* Setup function prototypes */
  55      =1  
  56      =1  /** Enable or disable interrupt for radio.
  57      =1   * Use this function to enable or disable
  58      =1   * one of the interrupt sources for the radio.
  59      =1   * This function only changes state for selected
  60      =1   * int_type, the rest of the interrupt sources
  61      =1   * are left unchanged.
  62      =1   *
  63      =1   * @param int_source Radio interrupt Source.
  64      =1   * @param irq_state Enable or Disable.
  65      =1  */
  66      =1  void hal_nrf_set_irq_mode(hal_nrf_irq_source_t int_source, bool irq_state);
  67      =1  
  68      =1  /* For the obsolete nRF24L01 it is necessary to issue an activate command before the
  69      =1   * features enabled by the FEATURE register can be used. For nRF24L01+ these features
  70      =1   * are by default enabled.
  71      =1  */
  72      =1  void hal_nrf_activate_features(void);
  73      =1  
  74      =1  /** Enables the dynamic packet length
  75      =1   * @param enable Whether enable or disable dynamic packet length
  76      =1   */
  77      =1  void hal_nrf_enable_dynamic_payload(bool enable);
  78      =1  
  79      =1  /** Enables the ACK payload feature
  80      =1   * @param enable Whether to enable or disable ACK payload
  81      =1   */
  82      =1  void hal_nrf_enable_ack_payload(bool enable);
  83      =1  
  84      =1  /** Enables the dynamic ack feature
  85      =1   * @param enable Whether to enable or disable Dynamic ACK
  86      =1   */
  87      =1  void hal_nrf_enable_dynamic_ack(bool enable);
  88      =1  
  89      =1  /** Function for enabling dynmic payload size.
  90      =1   * The input parameter contains is a byte where the bit values tells weather the
  91      =1   * pipe should use dynamic payload size. For example if bit 0 is set then 
  92      =1   * pipe 0 will accept dynamic payload size.
  93      =1   * @param setup Byte value telling for which pips(s) to enable dynamic payload size
  94      =1   */
  95      =1  void hal_nrf_setup_dynamic_payload(uint8_t setup);
  96      =1  
  97      =1  /** Reads the payload width of the received ack payload
  98      =1   * @return Payload width of the received ack payload
  99      =1   */
 100      =1  uint8_t hal_nrf_read_rx_payload_width(void);
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 16  

 101      =1  
 102      =1  /** Write ack payload
 103      =1   * Writes the payload that will be transmitted with the ack on the given pipe.
 104      =1   * @param pipe Pipe that transmits the payload
 105      =1   * @param tx_pload Pointer to the payload data
 106      =1   * @param length Size of the data to transmit
 107      =1   */
 108      =1  void hal_nrf_write_ack_payload(uint8_t pipe, const uint8_t data *tx_pload, uint8_t data length);
 109      =1  
 110      =1  /** Read then clears all interrupt flags.
 111      =1   * Use this function to get the interrupt flags and clear them in the same operation.
 112      =1   * Reduced radio interface activity and speed optimized.
 113      =1   *
 114      =1   * @return  Interrupt_flags
 115      =1   * @retval 0x10 Max Retransmit interrupt
 116      =1   * @retval 0x20 TX Data sent interrupt
 117      =1   * @retval 0x40 RX Data received interrupt
 118      =1  */
 119      =1  uint8_t hal_nrf_get_clear_irq_flags(void);
 120      =1  
 121      =1  /** Clear one selected interrupt flag.
 122      =1   * Use this function to clear one @a spesific interrupt flag.
 123      =1   * Other interrupt flags are left unchanged.
 124      =1   *
 125      =1   * @param int_source Interrupt source of which flag to clear
 126      =1  */
 127      =1  void hal_nrf_clear_irq_flag(hal_nrf_irq_source_t int_source);
 128      =1  
 129      =1  /** Set the CRC mode used by the radio.
 130      =1   * Use this function to set the CRC mode; CRC disabled, 1 or 2 bytes.
 131      =1   *
 132      =1   * @param crc_mode CRC mode to use
 133      =1  */
 134      =1  void hal_nrf_set_crc_mode(hal_nrf_crc_mode_t crc_mode);
 135      =1  
 136      =1  /** Open radio pipe(s) and enable/ disable auto acknowledge.
 137      =1   * Use this function to open one or all pipes,
 138      =1   * with or without auto acknowledge.
 139      =1   *
 140      =1   * @param pipe_num Radio pipe to open
 141      =1   * @param auto_ack Auto_Ack ON/OFF
 142      =1   * @see hal_nrf_address
 143      =1  */
 144      =1  void hal_nrf_open_pipe(hal_nrf_address_t pipe_num, bool auto_ack);
 145      =1  
 146      =1  /** Close radio pipe(s).
 147      =1   * Use this function to close one pipe or all pipes.
 148      =1   *
 149      =1   * @param pipe_num Pipe# number to close
 150      =1  */
 151      =1  void hal_nrf_close_pipe(hal_nrf_address_t pipe_num);
 152      =1  
 153      =1  /** Set radio's RX address and TX address.
 154      =1   * Use this function to set a RX address, or to set the TX address.
 155      =1   * Beware of the difference for single and multibyte address registers.
 156      =1   *
 157      =1   * @param address Which address to set
 158      =1   * @param *addr Buffer from which the address is stored in
 159      =1  */
 160      =1  void hal_nrf_set_address(const hal_nrf_address_t address, const uint8_t *addr);
 161      =1  
 162      =1  /** Get address for selected pipe.
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 17  

 163      =1   * Use this function to get address for selected pipe.
 164      =1   *
 165      =1   *
 166      =1   * @param address Which address to get, Pipe- or TX-address
 167      =1   * @param *addr buffer in which address bytes are written.
 168      =1   * <BR><BR>For pipes containing only LSB byte of address, this byte is returned
 169      =1   * in the<BR> *addr buffer.
 170      =1   *
 171      =1   * @return Numbers of bytes copied to addr
 172      =1  */
 173      =1  uint8_t hal_nrf_get_address (uint8_t address, uint8_t *addr);
 174      =1  
 175      =1  /** Set auto acknowledge parameters.
 176      =1   * Use this function to set retransmit and retransmit delay
 177      =1   * parameters.
 178      =1   *
 179      =1   * @param retr Number of retransmit, 0 equ retransmit OFF
 180      =1   * @param delay Retransmit delay in µs. Must be a 
 181      =1  */
 182      =1  void hal_nrf_set_auto_retr(uint8_t retr, uint16_t delay);
 183      =1  
 184      =1  /** Set radio's address width.
 185      =1   * Use this function to define the radio's address width,
 186      =1   * referes to both RX and TX.
 187      =1   *
 188      =1   * @param address_width Address with in bytes
 189      =1  */
 190      =1  void hal_nrf_set_address_width(hal_nrf_address_width_t address_width);
 191      =1  
 192      =1  /** Gets the radio's address width.
 193      =1   *
 194      =1   * @return Address width
 195      =1   */
 196      =1  uint8_t hal_nrf_get_address_width (void);
 197      =1  
 198      =1  /** Set payload width for selected pipe.
 199      =1   * Use this function to set the number of bytes expected
 200      =1   * on a selected pipe.
 201      =1   *
 202      =1   * @param pipe_num Pipe number to set payload width for
 203      =1   * @param pload_width number of bytes expected
 204      =1  */
 205      =1  void hal_nrf_set_rx_payload_width(uint8_t pipe_num, uint8_t pload_width);
 206      =1  
 207      =1  /** Read current interrupt mode for selected interrupt source.
 208      =1   * Use this function to get the interrupt source's mode,
 209      =1   * either enabled or disabled.
 210      =1   *
 211      =1   * @param int_source Interrupt source to get mode from
 212      =1   *
 213      =1   * @return Interrupt Mode
 214      =1   * @retval FALSE Interrupt disabled
 215      =1   * @retval TRUE Interrupt enabled
 216      =1  */
 217      =1  bool hal_nrf_get_irq_mode(uint8_t int_source);
 218      =1  
 219      =1  /** Read all interrupt flags.
 220      =1   * Use this function to get the interrupt flags. This function is similar
 221      =1   * to hal_nrf_get_clear_irq_flags with the exception that it does <I><B>NOT</B></I> clear
 222      =1   * the irq_flags.
 223      =1   *
 224      =1   * @return Interrupt_flags
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 18  

 225      =1   * @retval 0x10 Max Retransmit interrupt
 226      =1   * @retval 0x20 TX Data sent interrupt
 227      =1   * @retval 0x40 RX Data received interrupt
 228      =1  */
 229      =1  uint8_t hal_nrf_get_irq_flags(void);
 230      =1  
 231      =1  /** Get pipe status.
 232      =1   * Use this function to check status for a selected pipe.
 233      =1   *
 234      =1   * @param  pipe_num Pipe number to check status for
 235      =1   *
 236      =1   * @return Pipe_Status
 237      =1   * @retval 0x00 Pipe is closed, autoack disabled
 238      =1   * @retval 0x01 Pipe is open, autoack disabled
 239      =1   * @retval 0x03 Pipe is open, autoack enabled
 240      =1  */
 241      =1  uint8_t hal_nrf_get_pipe_status(uint8_t pipe_num);
 242      =1  
 243      =1  /** Get auto retransmit parameters.
 244      =1   * Use this function to get the auto retransmit parameters,
 245      =1   * retrans count and retrans delay.
 246      =1   *
 247      =1   * @return AutoRetrans Parameters
 248      =1   *
 249      =1   * @retval UpperNibble Retransmit Delay
 250      =1   * @retval LowerNibble Retransmit Count
 251      =1  */
 252      =1  uint8_t hal_nrf_get_auto_retr_status(void);
 253      =1  
 254      =1  /** Get packet lost counter
 255      =1   * Use this function to get the packet(s) counter.
 256      =1   *
 257      =1   * @return packet lost counter
 258      =1  */
 259      =1  uint8_t hal_nrf_get_packet_lost_ctr(void);
 260      =1  
 261      =1  /** Get RX payload width for selected pipe.
 262      =1   * Use this function to get the expected payload
 263      =1   * width for selected ppe number.
 264      =1   *
 265      =1   * @param pipe_num Pipe number to get payload width for
 266      =1   *
 267      =1   * @return Payload_Width in bytes                                                                                                                                       
 268      =1  */
 269      =1  uint8_t hal_nrf_get_rx_payload_width(uint8_t pipe_num);
 270      =1  //@}
 271      =1  
 272      =1  /** @name Operation */
 273      =1  //@{
 274      =1  /* Operation function prototypes */
 275      =1  
 276      =1  /** Set radio's operation mode.
 277      =1   * Use this function to enter PTX (primary TX)
 278      =1   * or PRX (primary RX).
 279      =1   *
 280      =1   * @param op_mode Operation mode
 281      =1  */
 282      =1  void hal_nrf_set_operation_mode(hal_nrf_operation_mode_t op_mode);
 283      =1  
 284      =1  /** Set radio's power mode.
 285      =1   * Use this function to power_up or power_down radio.
 286      =1   *
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 19  

 287      =1   * @param pwr_mode POWER_UP or POWER_DOWN
 288      =1  */
 289      =1  void hal_nrf_set_power_mode(hal_nrf_pwr_mode_t pwr_mode);
 290      =1  
 291      =1  /** Set radio's RF channel.
 292      =1   * Use this function to select which RF channel to use.
 293      =1   *
 294      =1   * @param channel RF channel
 295      =1  */
 296      =1  void hal_nrf_set_rf_channel(uint8_t channel);
 297      =1  
 298      =1  /** Set radio's TX output power.
 299      =1   * Use this function set the radio's TX output power.
 300      =1   *
 301      =1   * @param power Radio's TX output power
 302      =1  */
 303      =1  void hal_nrf_set_output_power(hal_nrf_output_power_t power);
 304      =1  
 305      =1  /** Set radio's on-air datarate.
 306      =1   * Use this function to select radio's on-air
 307      =1   * datarate.
 308      =1   *
 309      =1   * @param datarate On-air datarate
 310      =1  */
 311      =1  void hal_nrf_set_datarate(hal_nrf_datarate_t datarate);
 312      =1  
 313      =1  
 314      =1  /* Status functions prototypes */
 315      =1  
 316      =1  /** Get radio's TX FIFO status.
 317      =1   * Use this function to get the radio's TX
 318      =1   * FIFO status.
 319      =1   *
 320      =1   * @return TX FIFO status
 321      =1   * @retval 0x00 TX FIFO NOT empty, but NOT full
 322      =1   * @retval 0x01 FIFO empty
 323      =1   * @retval 0x02 FIFO full
 324      =1   *
 325      =1  */
 326      =1  uint8_t hal_nrf_get_tx_fifo_status(void);
 327      =1  
 328      =1  /** Check for TX FIFO empty.
 329      =1   * Use this function to check if TX FIFO
 330      =1   * is empty.
 331      =1   *
 332      =1   * @return TX FIFO empty bit
 333      =1   * @retval FALSE TX FIFO NOT empty
 334      =1   * @retval TRUE TX FIFO empty
 335      =1   *
 336      =1  */
 337      =1  bool hal_nrf_tx_fifo_empty(void);
 338      =1  
 339      =1  /** Check for TX FIFO full.
 340      =1   * Use this function to check if TX FIFO
 341      =1   * is full.
 342      =1   *
 343      =1   * @return TX FIFO full bit
 344      =1   * @retval FALSE TX FIFO NOT full
 345      =1   * @retval TRUE TX FIFO full
 346      =1   *
 347      =1  */
 348      =1  bool hal_nrf_tx_fifo_full(void);
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 20  

 349      =1  
 350      =1  /** Get radio's RX FIFO status.
 351      =1   * Use this function to get the radio's TX
 352      =1   * FIFO status.
 353      =1   *
 354      =1   * @return RX FIFO status
 355      =1   * @retval 0x00 RX FIFO NOT empty, but NOT full
 356      =1   * @retval 0x01 RX FIFO empty
 357      =1   * @retval 0x02 RX FIFO full
 358      =1   *
 359      =1  */
 360      =1  uint8_t hal_nrf_get_rx_fifo_status(void);
 361      =1  
 362      =1  /** Check for RX FIFO empty.
 363      =1   * Use this function to check if RX FIFO
 364      =1   * is empty.
 365      =1   *
 366      =1   * Reads STATUS register to check this, not FIFO_STATUS  
 367      =1   *
 368      =1   * @return RX FIFO empty bit
 369      =1   * @retval FALSE RX FIFO NOT empty
 370      =1   * @retval TRUE RX FIFO empty
 371      =1   *
 372      =1  */
 373      =1  bool hal_nrf_rx_fifo_empty(void);
 374      =1  
 375      =1  /** Check for RX FIFO full.
 376      =1   * Use this function to check if RX FIFO
 377      =1   * is full.
 378      =1   *
 379      =1   * @return RX FIFO full bit
 380      =1   * @retval FALSE RX FIFO NOT full
 381      =1   * @retval TRUE RX FIFO full
 382      =1   *
 383      =1  */
 384      =1  bool hal_nrf_rx_fifo_full(void);
 385      =1  
 386      =1  /** Get radio's transmit attempts status.
 387      =1   * Use this function to get number of retransmit
 388      =1   * attempts and number of packet lost.
 389      =1   *
 390      =1   * @return Retransmit attempts counters
 391      =1  */
 392      =1  uint8_t hal_nrf_get_transmit_attempts(void);
 393      =1  
 394      =1  /** Get the carrier detect flag.
 395      =1   * Use this function to get the carrier detect flag,
 396      =1   * used to detect stationary disturbance on selected
 397      =1   * RF channel.
 398      =1   *
 399      =1   * @return Carrier Detect
 400      =1   * @retval FALSE Carrier NOT Detected
 401      =1   * @retval TRUE Carrier Detected
 402      =1  */
 403      =1  bool hal_nrf_get_carrier_detect(void);
 404      =1  
 405      =1  /* Data operation prototypes */
 406      =1  
 407      =1  /** Get RX data source.
 408      =1   * Use this function to read which RX pipe data
 409      =1   * was received on for current top level FIFO data packet.
 410      =1   *
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 21  

 411      =1   * @return pipe number of current packet present
 412      =1  */
 413      =1  uint8_t hal_nrf_get_rx_data_source(void);
 414      =1  
 415      =1  /** Read RX payload.
 416      =1   * Use this function to read top level payload
 417      =1   * available in the RX FIFO.
 418      =1   *
 419      =1   * @param  *rx_pload pointer to buffer in which RX payload are stored
 420      =1   * @return pipe number (MSB byte) and packet length (LSB byte)
 421      =1  */
 422      =1  
 423      =1  uint16_t hal_nrf_read_rx_payload(uint8_t data *rx_pload);
 424      =1  uint16_t hal_nrf_read_multibyte_reg(uint8_t data reg, uint8_t data *pbuf);
 425      =1  
 426      =1  
 427      =1  /** Write TX payload to radio.
 428      =1   * Use this function to write a packet of
 429      =1   * TX payload into the radio.
 430      =1   * <I>length</I> number of bytes, which are stored in <I>*tx_pload</I>.
 431      =1   *
 432      =1   * @param *tx_pload pointer to buffer in which TX payload are present
 433      =1   * @param length number of bytes to write
 434      =1  */
 435      =1  void hal_nrf_write_tx_payload(const uint8_t data *tx_pload, uint8_t data length);
 436      =1  
 437      =1  /** Write TX payload which do not require ACK. When transmitting 
 438      =1   * a ACK is not required nor sent from the receiver. The payload will
 439      =1   * always be assumed as "sent".
 440      =1   *
 441      =1   * Use this function to write a packet of
 442      =1   * TX payload into the radio.
 443      =1   * <I>length</I> number of bytes, which are stored in <I>*tx_pload</I>.
 444      =1   *
 445      =1   * @param *tx_pload pointer to buffer in which TX payload are present
 446      =1   * @param length number of bytes to write
 447      =1  */
 448      =1  void hal_nrf_write_tx_payload_noack(const uint8_t data *tx_pload, uint8_t data length);
 449      =1  
 450      =1  /** Reuse TX payload.
 451      =1   * Use this function to set that the radio is using
 452      =1   * the last transmitted payload for the next packet as well.
 453      =1   *
 454      =1  */
 455      =1  void hal_nrf_reuse_tx(void);
 456      =1  
 457      =1  /** Get status of reuse TX function.
 458      =1   * Use this function to check if reuse TX payload is
 459      =1   * activated
 460      =1   *
 461      =1   * @return Reuse TX payload mode
 462      =1   * @retval FALSE Not activated
 463      =1   * @retval TRUE Activated
 464      =1  */
 465      =1  bool hal_nrf_get_reuse_tx_status(void);
 466      =1  
 467      =1  /** Flush RX FIFO.
 468      =1   * Use this function to flush the radio's
 469      =1   * RX FIFO.
 470      =1   *
 471      =1  */
 472      =1  void hal_nrf_flush_rx(void);
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 22  

 473      =1  
 474      =1  /** Flush TX FIFO.
 475      =1   * Use this function to flush the radio's
 476      =1   * TX FIFO.
 477      =1   *
 478      =1  */
 479      =1  void hal_nrf_flush_tx(void);
 480      =1  
 481      =1  /** No Operation command.
 482      =1   * Use this function to receive the radio's
 483      =1   * status register.
 484      =1   *
 485      =1   * @return Status register
 486      =1  */
 487      =1  uint8_t hal_nrf_nop(void);
 488      =1  //@}
 489      =1  
 490      =1  /** @name  Test */
 491      =1  //@{
 492      =1  /* Test functions prototypes */
 493      =1  
 494      =1  /** Set radio's PLL mode.
 495      =1   * Use this function to either LOCK
 496      =1   * or UNLOCK the radio's PLL.
 497      =1   *
 498      =1   * @param pll_lock PLL locked, TRUE or FALSE
 499      =1  */
 500      =1  void hal_nrf_set_pll_mode(bool pll_lock);
 501      =1  
 502      =1  /** Set radio's LNA gain mode.
 503      =1   * Use this function to either use HI
 504      =1   * current or LOW current mode for the radio.
 505      =1   *
 506      =1   * @param lna_gain LNA gain mode
 507      =1  */
 508      =1  void hal_nrf_set_lna_gain(bool lna_gain);
 509      =1  
 510      =1  /** Enables continuous carrier transmit.
 511      =1   * Use this function to enable or disable
 512      =1   * continuous carrier transmission.
 513      =1   * @param enable Enable continuous carrier
 514      =1   */
 515      =1  void hal_nrf_enable_continious_wave (bool enable);
 516      =1  
 517      =1  /* hal_nrf_l01 basic functions, used by all the other functions */
 518      =1  
 519      =1  //@}
 520      =1  
 521      =1  /** @name SPI interface */
 522      =1  //@{
 523      =1  
 524      =1  /** Basis function, nrf_rw
 525      =1   * This function is used by the basis functions
 526      =1   * to exchange data with the data.
 527      =1   *
 528      =1   * @param value Databyte to write
 529      =1   *
 530      =1   * @return Databyte from radio.
 531      =1  */
 532      =1  uint8_t hal_nrf_rw(uint8_t value);
 533      =1  //@}
 534      =1  #endif // HAL_NRF_H__
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 23  

 535      =1  /** @} */
 536      =1  
  28          
  29          sbit P0_0 = P0^0;
  30          sbit P0_4 = P0^4;
  31          sbit P0_5 = P0^5;
  32          sbit P0_6 = P0^6;
  33          sbit P0_7 = P0^7;
  34          
  35          #define SET_BIT(pos) ((uint8_t) (1<<( (uint8_t) (pos) )))
  36          #define UINT8(t) ((uint8_t) (t))
  37          
  38          /** Basis function read_reg.
  39           * Use this function to read the contents
  40           * of one radios register.
  41           *
  42           * @param reg Register to read
  43           * @return Register contents
  44          */
  45          static uint8_t hal_nrf_read_reg(uint8_t reg);
  46          
  47          /** Basis function write_reg.
  48           * Use this function to write a new value to
  49           * a radio register.
  50           *
  51           * @param reg Register to write
  52           * @param value New value to write
  53           * @return Status register
  54          */
  55          static uint8_t hal_nrf_write_reg(uint8_t data reg, uint8_t data value);
  56          
  57          /** Basis function, read_multibyte register .
  58           * Use this function to read multiple bytes from
  59           * a multibyte radio-register
  60           *
  61           * @param reg Multibyte register to read from
  62           * @param *pbuf Pointer to buffer in which to store read bytes to
  63           *
  64           * @return pipe# of received data (MSB), if operation used by a hal_nrf_read_rx_pload
  65           * @return length of read data (LSB), either for hal_nrf_read_rx_pload or
  66           * for hal_nrf_get_address.
  67          */
  68          //uint16_t hal_nrf_read_multibyte_reg(uint8_t data reg, uint8_t data *pbuf);
  69          
  70          /** Basis function, write_multibyte register.
  71           * Use this function to write multiple bytes to
  72           * a multiple radio register.
  73           *
  74           * @param reg Register to write
  75           * @param *pbuf pointer to buffer in which data to write is
  76           * @param length \# of bytes to write
  77          */
  78          static void hal_nrf_write_multibyte_reg(uint8_t reg, const uint8_t data *pbuf, uint8_t data length);
  79          
  80          /**
  81           * Typedef for the CONFIG register. Contains all the bitaddressable 
  82           * settings in the bits struct and the value sent to the radio in the uint8_t
  83           */
  84          typedef union {
  85            uint8_t value;
  86                  struct {
  87                          uint8_t prim_rx : 1;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 24  

  88                          uint8_t pwr_up : 1;
  89                          uint8_t crc0 : 1;
  90                          uint8_t en_crc : 1;
  91                          uint8_t mask_max_rt : 1;
  92                          uint8_t mask_tx_ds : 1;
  93                          uint8_t mask_rx_dr : 1;
  94                          const uint8_t : 1;
  95                  } bits;
  96          } config_t;
  97          
  98          /**
  99           * Typedef for the EN_AA, EN_RXADDR and DYNPD registers. Contains all the 
 100           * bitaddressable settings in the bits struct and the value sent to the radio 
 101           * in the uint8_t 
 102           */
 103          typedef union {
 104            uint8_t value;
 105            struct {
 106              uint8_t pipe_0 : 1;
 107              uint8_t pipe_1 : 1;
 108              uint8_t pipe_2 : 1;
 109              uint8_t pipe_3 : 1;
 110              uint8_t pipe_4 : 1;
 111              uint8_t pipe_5 : 1;
 112              const uint8_t : 2;
 113            } bits;
 114          } en_pipes_t;
 115          
 116          /**
 117           * Typedef for the SETUP_AW register. Contains all the bitaddressable 
 118           * settings in the bits struct and the value sent to the radio in the uint8_t
 119           */
 120          typedef union {
 121            uint8_t value;
 122                  struct {
 123                          uint8_t aw : 2;
 124                          const uint8_t : 6;              
 125                  } bits;
 126          } setup_aw_t;
 127          
 128          /**
 129           * Typedef for the SETUP_RETR register. Contains all the bitaddressable 
 130           * settings in the bits struct and the value sent to the radio in the uint8_t
 131           */
 132          typedef union {
 133            uint8_t value;
 134                  struct {
 135                          uint8_t arc : 4;
 136                          uint8_t ard : 4;
 137                  } bits;
 138          } setup_retr_t;
 139          
 140          /**
 141           * Typedef for the RF_CH register. Contains all the bitaddressable 
 142           * settings in the bits struct and the value sent to the radio in the uint8_t
 143           */
 144          typedef union {
 145            uint8_t value;
 146                  struct {
 147                          uint8_t rf_ch : 7;
 148                          const uint8_t : 1;
 149                  } bits;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 25  

 150          } rf_ch_t;
 151          
 152          /**
 153           * Typedef for the RF_SETUP register. Contains all the bitaddressable 
 154           * settings in the bits struct and the value sent to the radio in the uint8_t
 155           */
 156          typedef union {
 157            uint8_t value;
 158                  struct {
 159                          const uint8_t : 1;
 160                          uint8_t rf_pwr : 2;
 161                          uint8_t rf_dr_high : 1;
 162                          uint8_t pll_lock : 1;
 163                          uint8_t rf_dr_low : 1;
 164              const uint8_t : 1;
 165              uint8_t cont_wave : 1;
 166                  } bits;
 167          } rf_setup_t;
 168          
 169          /**
 170           * Typedef for the RX_PW_Px registers. Contains all the bitaddressable 
 171           * settings in the bits struct and the value sent to the radio in the uint8_t
 172           */
 173          typedef union {
 174            uint8_t value;
 175                  struct {
 176                          uint8_t rx_pw : 6;
 177                          const uint8_t : 2;
 178                  } bits;
 179          } rx_pw_t;
 180          
 181          /**
 182           * Typedef for the FEATURE register. Contains all the bitaddressable 
 183           * settings in the bits struct and the value sent to the radio in the uint8_t
 184           */
 185          typedef union {
 186            uint8_t value;
 187                  struct {
 188                          uint8_t en_dyn_ack : 1;
 189                          uint8_t en_ack_pay : 1;
 190                          uint8_t en_dpl : 1;
 191                          const uint8_t : 5;
 192                  } bits;
 193          } feature_t;
 194          
 195          void hal_nrf_set_operation_mode(hal_nrf_operation_mode_t op_mode)
 196          {
 197   1        config_t config;
 198   1        config.value = hal_nrf_read_reg (CONFIG);
 199   1      
 200   1        if(op_mode == HAL_NRF_PRX)
 201   1        {
 202   2          config.bits.prim_rx = 1;
 203   2        }
 204   1        else
 205   1        {
 206   2          config.bits.prim_rx = 0;
 207   2        }
 208   1      
 209   1        hal_nrf_write_reg (CONFIG, config.value);
 210   1      }
 211          
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 26  

 212          void hal_nrf_set_power_mode(hal_nrf_pwr_mode_t pwr_mode)
 213          {
 214   1        config_t config;
 215   1        config.value = hal_nrf_read_reg (CONFIG);
 216   1      
 217   1        if(pwr_mode == HAL_NRF_PWR_UP)
 218   1        {
 219   2          config.bits.pwr_up = 1;
 220   2        }
 221   1        else
 222   1        {
 223   2          config.bits.pwr_up = 0;
 224   2        }
 225   1        
 226   1        hal_nrf_write_reg (CONFIG, config.value);
 227   1      }
 228          
 229          void hal_nrf_set_crc_mode(hal_nrf_crc_mode_t crc_mode)
 230          {
 231   1        config_t config;
 232   1        config.value = hal_nrf_read_reg (CONFIG);
 233   1      
 234   1              switch (crc_mode)
 235   1              {
 236   2                      case HAL_NRF_CRC_OFF:
 237   2                              config.bits.en_crc = 0;
 238   2                              break;
 239   2                      case HAL_NRF_CRC_8BIT:
 240   2                              config.bits.en_crc = 1;
 241   2                              config.bits.crc0 = 0;
 242   2                              break;
 243   2                      case HAL_NRF_CRC_16BIT:
 244   2                              config.bits.en_crc = 1;
 245   2                              config.bits.crc0 = 1;
 246   2                              break;
 247   2                      default:
 248   2                              break;
 249   2              } 
 250   1      
 251   1        hal_nrf_write_reg (CONFIG, config.value);
 252   1      }
 253          
 254          void hal_nrf_set_irq_mode(hal_nrf_irq_source_t int_source, bool irq_state)
 255          {
 256   1        config_t config;
 257   1        config.value = hal_nrf_read_reg (CONFIG);
 258   1      
 259   1              switch (int_source)
 260   1              {
 261   2                      case HAL_NRF_MAX_RT:
 262   2                              config.bits.mask_max_rt = irq_state ? 0 : 1;
 263   2            break;
 264   2          case HAL_NRF_TX_DS:
 265   2            config.bits.mask_tx_ds = irq_state ? 0 : 1;
 266   2            break;
 267   2          case HAL_NRF_RX_DR:
 268   2            config.bits.mask_rx_dr = irq_state ? 0 : 1;
 269   2            break;
 270   2        }
 271   1        
 272   1        hal_nrf_write_reg (CONFIG, config.value);
 273   1      }
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 27  

 274          
 275          uint8_t hal_nrf_get_clear_irq_flags(void)
 276          {
 277   1        uint8_t retval;
 278   1        
 279   1        retval = hal_nrf_write_reg (STATUS, (BIT_6|BIT_5|BIT_4));
 280   1      
 281   1        return (retval & (BIT_6|BIT_5|BIT_4));
 282   1      }
 283          
 284          void hal_nrf_clear_irq_flag(hal_nrf_irq_source_t int_source)
 285          {
 286   1        hal_nrf_write_reg (STATUS, SET_BIT(int_source));
 287   1      }
 288          
 289          uint8_t hal_nrf_get_irq_flags(void)
 290          {
 291   1        return hal_nrf_nop() & (BIT_6|BIT_5|BIT_4);
 292   1      }
 293          
 294          void hal_nrf_open_pipe(hal_nrf_address_t pipe_num, bool auto_ack)
 295          {
 296   1        en_pipes_t en_rxaddr;
 297   1        en_pipes_t en_aa;
 298   1        en_rxaddr.value = hal_nrf_read_reg (EN_RXADDR);
 299   1        en_aa.value = hal_nrf_read_reg (EN_AA);
 300   1      
 301   1        switch(pipe_num)
 302   1        {
 303   2          case HAL_NRF_PIPE0:
 304   2          case HAL_NRF_PIPE1:
 305   2          case HAL_NRF_PIPE2:
 306   2          case HAL_NRF_PIPE3:
 307   2          case HAL_NRF_PIPE4:
 308   2          case HAL_NRF_PIPE5:
 309   2            en_rxaddr.value = en_rxaddr.value | SET_BIT(pipe_num);
 310   2      
 311   2            if(auto_ack)
 312   2            {
 313   3              en_aa.value = en_aa.value | SET_BIT(pipe_num);
 314   3            }
 315   2            else
 316   2            {
 317   3              en_aa.value = en_aa.value & ~SET_BIT(pipe_num);
 318   3            }
 319   2            break;
 320   2      
 321   2          case HAL_NRF_ALL:
 322   2            en_rxaddr.value = ~(BIT_6|BIT_7);
 323   2            
 324   2            if(auto_ack)
 325   2            {
 326   3              en_aa.value = ~(BIT_6|BIT_7);
 327   3            }
 328   2            else
 329   2            {
 330   3              en_aa.value = 0;
 331   3            }
 332   2            break;
 333   2            
 334   2          default:
 335   2            break;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 28  

 336   2        }
 337   1      
 338   1        hal_nrf_write_reg (EN_RXADDR, en_rxaddr.value);
 339   1        hal_nrf_write_reg (EN_AA, en_aa.value);
 340   1      }
 341          
 342          void hal_nrf_close_pipe(hal_nrf_address_t pipe_num)
 343          {
 344   1        en_pipes_t en_rxaddr;
 345   1        en_pipes_t en_aa;
 346   1        en_rxaddr.value = hal_nrf_read_reg (EN_RXADDR);
 347   1        en_aa.value = hal_nrf_read_reg (EN_AA);
 348   1      
 349   1        switch(pipe_num)
 350   1        {
 351   2          case HAL_NRF_PIPE0:
 352   2          case HAL_NRF_PIPE1:
 353   2          case HAL_NRF_PIPE2:
 354   2          case HAL_NRF_PIPE3:
 355   2          case HAL_NRF_PIPE4:
 356   2          case HAL_NRF_PIPE5:
 357   2            en_rxaddr.value = en_rxaddr.value & ~SET_BIT(pipe_num);
 358   2            en_aa.value = en_aa.value & ~SET_BIT(pipe_num);
 359   2            break;
 360   2          
 361   2          case HAL_NRF_ALL:
 362   2            en_rxaddr.value = 0;
 363   2            en_aa.value = 0;
 364   2            break;
 365   2            
 366   2          default:
 367   2            break;
 368   2        }
 369   1      
 370   1        hal_nrf_write_reg (EN_RXADDR, en_rxaddr.value);
 371   1        hal_nrf_write_reg (EN_AA, en_aa.value);
 372   1      }
 373          
 374          void hal_nrf_set_address(const hal_nrf_address_t address, const uint8_t *addr)
 375          {
 376   1        switch(address)
 377   1        {
 378   2          case HAL_NRF_TX:
 379   2          case HAL_NRF_PIPE0:
 380   2          case HAL_NRF_PIPE1:
 381   2            hal_nrf_write_multibyte_reg(W_REGISTER + RX_ADDR_P0 + (uint8_t) address, addr, hal_nrf_get_address_w
             -idth());
 382   2            break;
 383   2          case HAL_NRF_PIPE2:
 384   2          case HAL_NRF_PIPE3:
 385   2          case HAL_NRF_PIPE4:
 386   2          case HAL_NRF_PIPE5:
 387   2            hal_nrf_write_reg (RX_ADDR_P0 + (uint8_t) address, *addr);
 388   2            break;
 389   2      
 390   2          default:
 391   2            break;
 392   2        }
 393   1      }
 394          
 395          uint8_t hal_nrf_get_address(uint8_t address, uint8_t *addr)
 396          {
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 29  

 397   1        switch (address)
 398   1        {
 399   2          case HAL_NRF_PIPE0:
 400   2          case HAL_NRF_PIPE1:
 401   2          case HAL_NRF_TX:
 402   2            return hal_nrf_read_multibyte_reg (address, addr);
 403   2          default:
 404   2            *addr = hal_nrf_read_reg(RX_ADDR_P0 + address);
 405   2            return 1;
 406   2        }
 407   1      }
 408          
 409          void hal_nrf_set_auto_retr(uint8_t retr, uint16_t delay)
 410          {
 411   1        setup_retr_t setup_retr;
 412   1        setup_retr.bits.ard = (delay / 250) - 1;
 413   1        setup_retr.bits.arc = retr;
 414   1      
 415   1        hal_nrf_write_reg (SETUP_RETR, setup_retr.value);
 416   1      }
 417          
 418          void hal_nrf_set_address_width(hal_nrf_address_width_t aw)
 419          {
 420   1        setup_aw_t setup_aw;
 421   1        setup_aw.bits.aw = (uint8_t)aw - 2;
 422   1      
 423   1        hal_nrf_write_reg (SETUP_AW, setup_aw.value);
 424   1      }
 425          
 426          uint8_t hal_nrf_get_address_width (void)
 427          {
 428   1        return hal_nrf_read_reg (SETUP_AW) + 2;
 429   1      }
 430          
 431          void hal_nrf_set_rx_payload_width(uint8_t pipe_num, uint8_t pload_width)
 432          {
 433   1        hal_nrf_write_reg (RX_PW_P0 + pipe_num, pload_width);
 434   1      }
 435          
 436          uint8_t hal_nrf_get_pipe_status(uint8_t pipe_num)
 437          {
 438   1        en_pipes_t en_rxaddr;
 439   1        en_pipes_t en_aa;
 440   1        uint8_t en_rx_r, en_aa_r;
 441   1        
 442   1        en_rxaddr.value = hal_nrf_read_reg (EN_RXADDR);
 443   1        en_aa.value = hal_nrf_read_reg (EN_AA);
 444   1      
 445   1        switch (pipe_num)
 446   1        {
 447   2          case 0:
 448   2            en_rx_r = en_rxaddr.bits.pipe_0;
 449   2            en_aa_r = en_aa.bits.pipe_0;
 450   2            break;
 451   2          case 1:
 452   2            en_rx_r = en_rxaddr.bits.pipe_1;
 453   2            en_aa_r = en_aa.bits.pipe_1;
 454   2            break;
 455   2          case 2:
 456   2            en_rx_r = en_rxaddr.bits.pipe_2;
 457   2            en_aa_r = en_aa.bits.pipe_2;
 458   2            break;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 30  

 459   2          case 3:
 460   2            en_rx_r = en_rxaddr.bits.pipe_3;
 461   2            en_aa_r = en_aa.bits.pipe_3;
 462   2            break;
 463   2          case 4:
 464   2            en_rx_r = en_rxaddr.bits.pipe_4;
 465   2            en_aa_r = en_aa.bits.pipe_4;
 466   2            break;
 467   2          case 5:
 468   2            en_rx_r = en_rxaddr.bits.pipe_5;
 469   2            en_aa_r = en_aa.bits.pipe_5;
 470   2            break;
 471   2          default:
 472   2            en_rx_r = 0;
 473   2            en_aa_r = 0;
 474   2            break;
 475   2        }
 476   1        
 477   1        return (uint8_t)(en_aa_r << 1) + en_rx_r;
 478   1      }
 479          
 480          uint8_t hal_nrf_get_auto_retr_status(void)
 481          {
 482   1        return hal_nrf_read_reg(OBSERVE_TX);
 483   1      }
 484          
 485          uint8_t hal_nrf_get_packet_lost_ctr(void)
 486          {
 487   1        return ((hal_nrf_read_reg(OBSERVE_TX) & (BIT_7|BIT_6|BIT_5|BIT_4)) >> 4);
 488   1      }
 489          
 490          uint8_t hal_nrf_get_rx_payload_width(uint8_t pipe_num)
 491          {
 492   1        uint8_t pw;
 493   1      
 494   1        switch (pipe_num)
 495   1        {
 496   2          case 0:
 497   2            pw = hal_nrf_read_reg (RX_PW_P0);
 498   2            break;      
 499   2          case 1:
 500   2            pw = hal_nrf_read_reg (RX_PW_P1);
 501   2            break;
 502   2          case 2:
 503   2            pw = hal_nrf_read_reg (RX_PW_P2);
 504   2            break;
 505   2          case 3:
 506   2            pw = hal_nrf_read_reg (RX_PW_P3);
 507   2            break;
 508   2          case 4:
 509   2            pw = hal_nrf_read_reg (RX_PW_P4);
 510   2            break;
 511   2          case 5:
 512   2            pw = hal_nrf_read_reg (RX_PW_P5);
 513   2            break;
 514   2          default:
 515   2            pw = 0;
 516   2            break;
 517   2        }
 518   1      
 519   1        return pw;
 520   1      }
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 31  

 521          
 522          void hal_nrf_set_rf_channel(uint8_t channel)
 523          {
 524   1        rf_ch_t rf_ch;
 525   1        rf_ch.bits.rf_ch = channel;
 526   1        
 527   1        hal_nrf_write_reg (RF_CH, rf_ch.value);
 528   1      }
 529          
 530          void hal_nrf_set_output_power(hal_nrf_output_power_t power)
 531          {
 532   1        rf_setup_t rf_setup;
 533   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 534   1      
 535   1        rf_setup.bits.rf_pwr = (uint8_t)power;
 536   1        
 537   1        hal_nrf_write_reg (RF_SETUP, rf_setup.value);
 538   1      }
 539          
 540          void hal_nrf_set_datarate(hal_nrf_datarate_t datarate)
 541          {
 542   1        rf_setup_t rf_setup;
 543   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 544   1        
 545   1        switch (datarate)
 546   1        {
 547   2          case HAL_NRF_250KBPS:
 548   2            rf_setup.bits.rf_dr_low = 1;
 549   2            rf_setup.bits.rf_dr_high = 0;
 550   2            break;
 551   2          case HAL_NRF_1MBPS:
 552   2            rf_setup.bits.rf_dr_low = 0;
 553   2            rf_setup.bits.rf_dr_high = 0;
 554   2            break;
 555   2          case HAL_NRF_2MBPS:
 556   2          default:
 557   2            rf_setup.bits.rf_dr_low = 0;
 558   2            rf_setup.bits.rf_dr_high = 1;
 559   2            break;
 560   2        }
 561   1        
 562   1        hal_nrf_write_reg (RF_SETUP, rf_setup.value);
 563   1      }
 564          
 565          bool hal_nrf_rx_fifo_empty(void)
 566          {
 567   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS) >> RX_EMPTY) & 1);
 568   1      }
 569          
 570          bool hal_nrf_rx_fifo_full(void)
 571          {
 572   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS)>> RX_FULL) & 1);
 573   1      }
 574          
 575          bool hal_nrf_tx_fifo_empty(void)
 576          {
 577   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS) >> TX_EMPTY) & 1);
 578   1      }
 579          
 580          bool hal_nrf_tx_fifo_full(void)
 581          {
 582   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS) >> TX_FIFO_FULL) & 1);
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 32  

 583   1      }
 584          
 585          uint8_t hal_nrf_get_tx_fifo_status(void)
 586          {
 587   1        return ((hal_nrf_read_reg(FIFO_STATUS) & ((1<<TX_FIFO_FULL)|(1<<TX_EMPTY))) >> 4);
 588   1      }
 589          
 590          uint8_t hal_nrf_get_rx_fifo_status(void)
 591          {
 592   1        return (hal_nrf_read_reg(FIFO_STATUS) & ((1<<RX_FULL)|(1<<RX_EMPTY)));
 593   1      }
 594          
 595          uint8_t hal_nrf_get_fifo_status(void)
 596          {
 597   1        return hal_nrf_read_reg(FIFO_STATUS);
 598   1      }
 599          
 600          uint8_t hal_nrf_get_transmit_attempts(void)
 601          {
 602   1        return (hal_nrf_read_reg(OBSERVE_TX) & (BIT_3|BIT_2|BIT_1|BIT_0));
 603   1      }
 604          
 605          bool hal_nrf_get_carrier_detect(void)
 606          {
 607   1        return hal_nrf_read_reg(CD) & 1;
 608   1      }
 609          
 610          void hal_nrf_activate_features(void)
 611          {return;}
 612          
 613          void hal_nrf_setup_dynamic_payload (uint8_t setup)
 614          {
 615   1        en_pipes_t dynpd;
 616   1        dynpd.value = setup & ~0xC0;
 617   1      
 618   1        hal_nrf_write_reg (DYNPD, dynpd.value);
 619   1      }
 620          
 621          void hal_nrf_enable_dynamic_payload(bool enable)
 622          {
 623   1        feature_t feature;
 624   1        feature.value = hal_nrf_read_reg (FEATURE);
 625   1        feature.bits.en_dpl = (enable) ? 1 : 0;
 626   1      
 627   1        hal_nrf_write_reg (FEATURE, feature.value);
 628   1      }
 629          
 630          void hal_nrf_enable_ack_payload(bool enable)
 631          {
 632   1        feature_t feature;
 633   1        feature.value = hal_nrf_read_reg (FEATURE);
 634   1        feature.bits.en_ack_pay = (enable) ? 1 : 0;
 635   1      
 636   1        hal_nrf_write_reg (FEATURE, feature.value);
 637   1      }
 638          
 639          void hal_nrf_enable_dynamic_ack(bool enable)
 640          {
 641   1        feature_t feature;
 642   1        feature.value = hal_nrf_read_reg (FEATURE);
 643   1        feature.bits.en_dyn_ack = (enable) ? 1 : 0;
 644   1      
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 33  

 645   1        hal_nrf_write_reg (FEATURE, feature.value);
 646   1      }
 647          
 648          void hal_nrf_write_tx_payload(const uint8_t data *tx_pload, uint8_t data length)
 649          {
 650   1        hal_nrf_write_multibyte_reg(W_TX_PAYLOAD, tx_pload, length);
 651   1      }
 652          
 653          void hal_nrf_write_tx_payload_noack(const uint8_t data *tx_pload, uint8_t data length)
 654          {
 655   1        hal_nrf_write_multibyte_reg(W_TX_PAYLOAD_NOACK, tx_pload, length);
 656   1      }
 657          
 658          void hal_nrf_write_ack_payload(uint8_t pipe, const uint8_t data *tx_pload, uint8_t data length)
 659          {
 660   1        hal_nrf_write_multibyte_reg(W_ACK_PAYLOAD | pipe, tx_pload, length);
 661   1      }
 662          
 663          uint8_t hal_nrf_read_rx_payload_width()
 664          {
 665   1        return hal_nrf_read_reg(R_RX_PL_WID);
 666   1      }
 667          
 668          uint16_t hal_nrf_read_rx_payload(uint8_t data *rx_pload)
 669          {
 670   1        return hal_nrf_read_multibyte_reg(UINT8(HAL_NRF_RX_PLOAD), rx_pload);
 671   1      }
 672          
 673          uint8_t hal_nrf_get_rx_data_source(void)
 674          {
 675   1        return ((hal_nrf_nop() & (BIT_3|BIT_2|BIT_1)) >> 1);
 676   1      }
 677          
 678          void hal_nrf_reuse_tx(void)
 679          {
 680   1        CSN_LOW();
 681   1        hal_nrf_rw(REUSE_TX_PL);
 682   1        CSN_HIGH();
 683   1      }
 684          
 685          bool hal_nrf_get_reuse_tx_status(void)
 686          {
 687   1        return (bool)((hal_nrf_get_fifo_status() & (1<<TX_REUSE)) >> TX_REUSE);
 688   1      }
 689          
 690          void hal_nrf_flush_rx(void)
 691          {
 692   1        CSN_LOW();
 693   1        hal_nrf_rw(FLUSH_RX);
 694   1        CSN_HIGH();
 695   1      }
 696          
 697          void hal_nrf_flush_tx(void)
 698          {
 699   1        CSN_LOW();
 700   1        hal_nrf_rw(FLUSH_TX);
 701   1        CSN_HIGH();
 702   1      }
 703          
 704          uint8_t hal_nrf_nop(void)
 705          {
 706   1        uint8_t retval;
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 34  

 707   1      
 708   1        CSN_LOW();
 709   1        retval = hal_nrf_rw(NOP);
 710   1        CSN_HIGH();
 711   1      
 712   1        return retval;
 713   1      }
 714          
 715          void hal_nrf_set_pll_mode(bool pll_lock)
 716          {
 717   1        rf_setup_t rf_setup;
 718   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 719   1        rf_setup.bits.pll_lock = (pll_lock) ? 1 : 0;
 720   1      
 721   1        hal_nrf_write_reg(RF_SETUP, rf_setup.value);
 722   1      }
 723          
 724          void hal_nrf_enable_continious_wave (bool enable)
 725          {
 726   1        rf_setup_t rf_setup;
 727   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 728   1        rf_setup.bits.cont_wave = (enable ? 1 : 0);
 729   1      
 730   1        hal_nrf_write_reg(RF_SETUP, rf_setup.value);
 731   1      }
 732          
 733          static uint8_t hal_nrf_read_reg(uint8_t data reg)
 734          {
 735   1        uint8_t temp;
 736   1      
 737   1        CSN_LOW();
 738   1        hal_nrf_rw(reg);
 739   1        temp = hal_nrf_rw(0);
 740   1        CSN_HIGH();
 741   1      
 742   1        return temp;
 743   1      }
 744          
 745          uint8_t hal_nrf_write_reg(uint8_t data reg, uint8_t data value)
 746          {
 747   1        uint8_t data retval;
 748   1        
 749   1        CSN_LOW();
 750   1        // retval = hal_nrf_rw(W_REGISTER + reg);
 751   1      
 752   1        RFDAT = W_REGISTER + reg;
 753   1        RFSPIF = 0;     // ! IMPORTANT ! Clear RF SPI ready flag
 754   1                        // after data written to RFDAT..
 755   1        while(!RFSPIF); // wait for byte transfer finished
 756   1          
 757   1        retval = RFDAT;   // return SPI read value
 758   1      
 759   1      
 760   1        RFDAT = value;
 761   1        RFSPIF = 0;     // ! IMPORTANT ! Clear RF SPI ready flag
 762   1                        // after data written to RFDAT..
 763   1        while(!RFSPIF); // wait for byte transfer finished
 764   1          
 765   1        // retval = RFDAT;   // return SPI read value
 766   1      
 767   1       //  hal_nrf_rw(value);
 768   1        CSN_HIGH();
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 35  

 769   1      
 770   1        return retval;
 771   1      }
 772          
 773          uint16_t hal_nrf_read_multibyte_reg(uint8_t data reg, uint8_t data *pbuf)
 774          {
 775   1        uint8_t data ctr, length;
 776   1        switch(reg)
 777   1        {
 778   2          case HAL_NRF_PIPE0:
 779   2          case HAL_NRF_PIPE1:
 780   2          case HAL_NRF_TX:
 781   2            length = ctr = hal_nrf_get_address_width();
 782   2            CSN_LOW();
 783   2            hal_nrf_rw(RX_ADDR_P0 + reg);
 784   2            break;
 785   2            
 786   2          case HAL_NRF_RX_PLOAD:
 787   2            if( (reg = hal_nrf_get_rx_data_source()) < 7)
 788   2            {
 789   3              length = ctr = hal_nrf_read_rx_payload_width();
 790   3              CSN_LOW();
 791   3              hal_nrf_rw(R_RX_PAYLOAD);
 792   3            }
 793   2            else
 794   2            {
 795   3              ctr = length = 0;
 796   3            }
 797   2            break;
 798   2      
 799   2          default:
 800   2            ctr = length = 0;
 801   2            break;
 802   2        }
 803   1      
 804   1        while(ctr--)
 805   1        {
 806   2          *pbuf++ = hal_nrf_rw(0);
 807   2        }
 808   1      
 809   1        CSN_HIGH();
 810   1      
 811   1        return (((uint16_t) reg << 8) | length);
 812   1      }
 813          
 814          static void hal_nrf_write_multibyte_reg( uint8_t data cmd, const uint8_t data *pbuf, uint8_t data length)
 815          {
 816   1        data uint8_t dummy;
 817   1      
 818   1        CSN_LOW();
 819   1      
 820   1        HAL_NRF_HW_SPI_WRITE(cmd);
 821   1      
 822   1        for(; length > 0; --length, ++pbuf)
 823   1       {
 824   2         // next = *(pbuf + i);
 825   2          while(HAL_NRF_HW_SPI_BUSY);  // wait for byte transfer finished
 826   2          ;
 827   2          dummy = HAL_NRF_HW_SPI_READ();
 828   2          HAL_NRF_HW_SPI_WRITE(*pbuf);    
 829   2        }
 830   1       
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 36  

 831   1        while(HAL_NRF_HW_SPI_BUSY);  // wait for byte transfer finished
 832   1        ;
 833   1        dummy = HAL_NRF_HW_SPI_READ();
 834   1        CSN_HIGH();
 835   1      }
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 37  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION _hal_nrf_set_operation_mode (BEGIN)
                                           ; SOURCE LINE # 195
0000 900000      R     MOV     DPTR,#op_mode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 198
0005 E4                CLR     A
0006 FF                MOV     R7,A
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#config
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 200
000F 900000      R     MOV     DPTR,#op_mode
0012 E0                MOVX    A,@DPTR
0013 B40107            CJNE    A,#01H,?C0001
                                           ; SOURCE LINE # 201
                                           ; SOURCE LINE # 202
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 4401              ORL     A,#01H
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 203
001B 8007              SJMP    ?C0002
001D         ?C0001:
                                           ; SOURCE LINE # 205
                                           ; SOURCE LINE # 206
001D 900000      R     MOV     DPTR,#config
0020 E0                MOVX    A,@DPTR
0021 54FE              ANL     A,#0FEH
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 207
0024         ?C0002:
                                           ; SOURCE LINE # 209
0024 900000      R     MOV     DPTR,#config
0027 E0                MOVX    A,@DPTR
0028 FD                MOV     R5,A
0029 E4                CLR     A
002A FF                MOV     R7,A
002B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_operation_mode (END)

             ; FUNCTION _hal_nrf_set_power_mode (BEGIN)
                                           ; SOURCE LINE # 212
0000 900000      R     MOV     DPTR,#pwr_mode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 213
                                           ; SOURCE LINE # 215
0005 E4                CLR     A
0006 FF                MOV     R7,A
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#config
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 217
000F 900000      R     MOV     DPTR,#pwr_mode
0012 E0                MOVX    A,@DPTR
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 38  

0013 B40107            CJNE    A,#01H,?C0004
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 219
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 4402              ORL     A,#02H
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 220
001B 8007              SJMP    ?C0005
001D         ?C0004:
                                           ; SOURCE LINE # 222
                                           ; SOURCE LINE # 223
001D 900000      R     MOV     DPTR,#config
0020 E0                MOVX    A,@DPTR
0021 54FD              ANL     A,#0FDH
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 224
0024         ?C0005:
                                           ; SOURCE LINE # 226
0024 900000      R     MOV     DPTR,#config
0027 E0                MOVX    A,@DPTR
0028 FD                MOV     R5,A
0029 E4                CLR     A
002A FF                MOV     R7,A
002B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_power_mode (END)

             ; FUNCTION _hal_nrf_set_crc_mode (BEGIN)
                                           ; SOURCE LINE # 229
0000 900000      R     MOV     DPTR,#crc_mode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 230
                                           ; SOURCE LINE # 232
0005 E4                CLR     A
0006 FF                MOV     R7,A
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#config
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 234
000F 900000      R     MOV     DPTR,#crc_mode
0012 E0                MOVX    A,@DPTR
0013 14                DEC     A
0014 6010              JZ      ?C0009
0016 14                DEC     A
0017 601A              JZ      ?C0010
0019 2402              ADD     A,#02H
001B 7021              JNZ     ?C0007
                                           ; SOURCE LINE # 235
                                           ; SOURCE LINE # 236
001D         ?C0008:
                                           ; SOURCE LINE # 237
001D 900000      R     MOV     DPTR,#config
0020 E0                MOVX    A,@DPTR
0021 54F7              ANL     A,#0F7H
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 238
0024 8018              SJMP    ?C0007
                                           ; SOURCE LINE # 239
0026         ?C0009:
                                           ; SOURCE LINE # 240
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 39  

0026 900000      R     MOV     DPTR,#config
0029 E0                MOVX    A,@DPTR
002A 4408              ORL     A,#08H
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 241
002D E0                MOVX    A,@DPTR
002E 54FB              ANL     A,#0FBH
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 242
0031 800B              SJMP    ?C0007
                                           ; SOURCE LINE # 243
0033         ?C0010:
                                           ; SOURCE LINE # 244
0033 900000      R     MOV     DPTR,#config
0036 E0                MOVX    A,@DPTR
0037 4408              ORL     A,#08H
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 245
003A E0                MOVX    A,@DPTR
003B 4404              ORL     A,#04H
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 246
                                           ; SOURCE LINE # 247
                                           ; SOURCE LINE # 248
                                           ; SOURCE LINE # 249
003E         ?C0007:
                                           ; SOURCE LINE # 251
003E 900000      R     MOV     DPTR,#config
0041 E0                MOVX    A,@DPTR
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FF                MOV     R7,A
0045 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_crc_mode (END)

             ; FUNCTION _hal_nrf_set_irq_mode (BEGIN)
                                           ; SOURCE LINE # 254
0000 900000      R     MOV     DPTR,#int_source
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 255
                                           ; SOURCE LINE # 257
0008 E4                CLR     A
0009 FF                MOV     R7,A
000A 120000      R     LCALL   _hal_nrf_read_reg
000D 900000      R     MOV     DPTR,#config
0010 EF                MOV     A,R7
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 259
0012 900000      R     MOV     DPTR,#int_source
0015 E0                MOVX    A,@DPTR
0016 24FB              ADD     A,#0FBH
0018 6024              JZ      ?C0017
001A 14                DEC     A
001B 603F              JZ      ?C0020
001D 2402              ADD     A,#02H
001F 7058              JNZ     ?C0013
                                           ; SOURCE LINE # 260
                                           ; SOURCE LINE # 261
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 40  

0021         ?C0014:
                                           ; SOURCE LINE # 262
0021 900000      R     MOV     DPTR,#irq_state
0024 E0                MOVX    A,@DPTR
0025 6004              JZ      ?C0015
0027 7F00              MOV     R7,#00H
0029 8002              SJMP    ?C0016
002B         ?C0015:
002B 7F01              MOV     R7,#01H
002D         ?C0016:
002D EF                MOV     A,R7
002E 5401              ANL     A,#01H
0030 C4                SWAP    A
0031 54F0              ANL     A,#0F0H
0033 FF                MOV     R7,A
0034 900000      R     MOV     DPTR,#config
0037 E0                MOVX    A,@DPTR
0038 54EF              ANL     A,#0EFH
003A 4F                ORL     A,R7
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 263
003C 803B              SJMP    ?C0013
                                           ; SOURCE LINE # 264
003E         ?C0017:
                                           ; SOURCE LINE # 265
003E 900000      R     MOV     DPTR,#irq_state
0041 E0                MOVX    A,@DPTR
0042 6004              JZ      ?C0018
0044 7F00              MOV     R7,#00H
0046 8002              SJMP    ?C0019
0048         ?C0018:
0048 7F01              MOV     R7,#01H
004A         ?C0019:
004A EF                MOV     A,R7
004B 5401              ANL     A,#01H
004D C4                SWAP    A
004E 33                RLC     A
004F 54E0              ANL     A,#0E0H
0051 FF                MOV     R7,A
0052 900000      R     MOV     DPTR,#config
0055 E0                MOVX    A,@DPTR
0056 54DF              ANL     A,#0DFH
0058 4F                ORL     A,R7
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 266
005A 801D              SJMP    ?C0013
                                           ; SOURCE LINE # 267
005C         ?C0020:
                                           ; SOURCE LINE # 268
005C 900000      R     MOV     DPTR,#irq_state
005F E0                MOVX    A,@DPTR
0060 6004              JZ      ?C0021
0062 7F00              MOV     R7,#00H
0064 8002              SJMP    ?C0022
0066         ?C0021:
0066 7F01              MOV     R7,#01H
0068         ?C0022:
0068 EF                MOV     A,R7
0069 5401              ANL     A,#01H
006B C4                SWAP    A
006C 33                RLC     A
006D 33                RLC     A
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 41  

006E 54C0              ANL     A,#0C0H
0070 FF                MOV     R7,A
0071 900000      R     MOV     DPTR,#config
0074 E0                MOVX    A,@DPTR
0075 54BF              ANL     A,#0BFH
0077 4F                ORL     A,R7
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 269
                                           ; SOURCE LINE # 270
0079         ?C0013:
                                           ; SOURCE LINE # 272
0079 900000      R     MOV     DPTR,#config
007C E0                MOVX    A,@DPTR
007D FD                MOV     R5,A
007E E4                CLR     A
007F FF                MOV     R7,A
0080 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_irq_mode (END)

             ; FUNCTION hal_nrf_get_clear_irq_flags (BEGIN)
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 276
                                           ; SOURCE LINE # 279
0000 7D70              MOV     R5,#070H
0002 7F07              MOV     R7,#07H
0004 120000      R     LCALL   _hal_nrf_write_reg
;---- Variable 'retval' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 281
0007 EF                MOV     A,R7
0008 5470              ANL     A,#070H
000A FF                MOV     R7,A
                                           ; SOURCE LINE # 282
000B         ?C0024:
000B 22                RET     
             ; FUNCTION hal_nrf_get_clear_irq_flags (END)

             ; FUNCTION _hal_nrf_clear_irq_flag (BEGIN)
                                           ; SOURCE LINE # 284
;---- Variable 'int_source' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 285
                                           ; SOURCE LINE # 286
0000 7401              MOV     A,#01H
0002 A807              MOV     R0,AR7
0004 08                INC     R0
0005 8002              SJMP    ?C0219
0007         ?C0218:
0007 C3                CLR     C
0008 33                RLC     A
0009         ?C0219:
0009 D8FC              DJNZ    R0,?C0218
000B FD                MOV     R5,A
000C 7F07              MOV     R7,#07H
000E 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_clear_irq_flag (END)

             ; FUNCTION hal_nrf_get_irq_flags (BEGIN)
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 290
                                           ; SOURCE LINE # 291
0000 120000      R     LCALL   hal_nrf_nop
0003 EF                MOV     A,R7
0004 5470              ANL     A,#070H
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 42  

0006 FF                MOV     R7,A
                                           ; SOURCE LINE # 292
0007         ?C0026:
0007 22                RET     
             ; FUNCTION hal_nrf_get_irq_flags (END)

             ; FUNCTION _hal_nrf_open_pipe (BEGIN)
                                           ; SOURCE LINE # 294
0000 900000      R     MOV     DPTR,#pipe_num
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 295
                                           ; SOURCE LINE # 298
0008 7F02              MOV     R7,#02H
000A 120000      R     LCALL   _hal_nrf_read_reg
000D 900000      R     MOV     DPTR,#en_rxaddr
0010 EF                MOV     A,R7
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 299
0012 7F01              MOV     R7,#01H
0014 120000      R     LCALL   _hal_nrf_read_reg
0017 900000      R     MOV     DPTR,#en_aa
001A EF                MOV     A,R7
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 301
001C 900000      R     MOV     DPTR,#pipe_num
001F E0                MOVX    A,@DPTR
0020 FF                MOV     R7,A
0021 24FA              ADD     A,#0FAH
0023 5006              JNC     ?C0033
0025 2407              ADD     A,#07H
0027 603C              JZ      ?C0036
0029 8053              SJMP    ?C0027
                                           ; SOURCE LINE # 302
                                           ; SOURCE LINE # 303
                                           ; SOURCE LINE # 304
                                           ; SOURCE LINE # 305
                                           ; SOURCE LINE # 306
                                           ; SOURCE LINE # 307
                                           ; SOURCE LINE # 308
002B         ?C0033:
                                           ; SOURCE LINE # 309
002B 7401              MOV     A,#01H
002D A807              MOV     R0,AR7
002F 08                INC     R0
0030 8002              SJMP    ?C0221
0032         ?C0220:
0032 C3                CLR     C
0033 33                RLC     A
0034         ?C0221:
0034 D8FC              DJNZ    R0,?C0220
0036 FD                MOV     R5,A
0037 900000      R     MOV     DPTR,#en_rxaddr
003A E0                MOVX    A,@DPTR
003B 4D                ORL     A,R5
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 311
003D 900000      R     MOV     DPTR,#auto_ack
0040 E0                MOVX    A,@DPTR
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 43  

0041 6008              JZ      ?C0034
                                           ; SOURCE LINE # 312
                                           ; SOURCE LINE # 313
0043 900000      R     MOV     DPTR,#en_aa
0046 E0                MOVX    A,@DPTR
0047 4D                ORL     A,R5
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 314
0049 8033              SJMP    ?C0027
004B         ?C0034:
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
004B 900000      R     MOV     DPTR,#pipe_num
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 7401              MOV     A,#01H
0052 A807              MOV     R0,AR7
0054 08                INC     R0
0055 8002              SJMP    ?C0223
0057         ?C0222:
0057 C3                CLR     C
0058 33                RLC     A
0059         ?C0223:
0059 D8FC              DJNZ    R0,?C0222
005B F4                CPL     A
005C FF                MOV     R7,A
005D 900000      R     MOV     DPTR,#en_aa
0060 E0                MOVX    A,@DPTR
0061 5F                ANL     A,R7
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 318
                                           ; SOURCE LINE # 319
0063 8019              SJMP    ?C0027
                                           ; SOURCE LINE # 321
0065         ?C0036:
                                           ; SOURCE LINE # 322
0065 900000      R     MOV     DPTR,#en_rxaddr
0068 743F              MOV     A,#03FH
006A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 324
006B 900000      R     MOV     DPTR,#auto_ack
006E E0                MOVX    A,@DPTR
006F 6008              JZ      ?C0037
                                           ; SOURCE LINE # 325
                                           ; SOURCE LINE # 326
0071 900000      R     MOV     DPTR,#en_aa
0074 743F              MOV     A,#03FH
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 327
0077 8005              SJMP    ?C0027
0079         ?C0037:
                                           ; SOURCE LINE # 329
                                           ; SOURCE LINE # 330
0079 E4                CLR     A
007A 900000      R     MOV     DPTR,#en_aa
007D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 331
                                           ; SOURCE LINE # 332
                                           ; SOURCE LINE # 334
                                           ; SOURCE LINE # 335
                                           ; SOURCE LINE # 336
007E         ?C0027:
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 44  

                                           ; SOURCE LINE # 338
007E 900000      R     MOV     DPTR,#en_rxaddr
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 7F02              MOV     R7,#02H
0085 120000      R     LCALL   _hal_nrf_write_reg
                                           ; SOURCE LINE # 339
0088 900000      R     MOV     DPTR,#en_aa
008B E0                MOVX    A,@DPTR
008C FD                MOV     R5,A
008D 7F01              MOV     R7,#01H
008F 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_open_pipe (END)

             ; FUNCTION _hal_nrf_close_pipe (BEGIN)
                                           ; SOURCE LINE # 342
0000 900000      R     MOV     DPTR,#pipe_num
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 343
                                           ; SOURCE LINE # 346
0005 7F02              MOV     R7,#02H
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#en_rxaddr
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 347
000F 7F01              MOV     R7,#01H
0011 120000      R     LCALL   _hal_nrf_read_reg
0014 900000      R     MOV     DPTR,#en_aa
0017 EF                MOV     A,R7
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 349
0019 900000      R     MOV     DPTR,#pipe_num
001C E0                MOVX    A,@DPTR
001D FF                MOV     R7,A
001E 24FA              ADD     A,#0FAH
0020 5006              JNC     ?C0047
0022 2407              ADD     A,#07H
0024 601B              JZ      ?C0048
0026 8020              SJMP    ?C0041
                                           ; SOURCE LINE # 350
                                           ; SOURCE LINE # 351
                                           ; SOURCE LINE # 352
                                           ; SOURCE LINE # 353
                                           ; SOURCE LINE # 354
                                           ; SOURCE LINE # 355
                                           ; SOURCE LINE # 356
0028         ?C0047:
                                           ; SOURCE LINE # 357
0028 7401              MOV     A,#01H
002A A807              MOV     R0,AR7
002C 08                INC     R0
002D 8002              SJMP    ?C0225
002F         ?C0224:
002F C3                CLR     C
0030 33                RLC     A
0031         ?C0225:
0031 D8FC              DJNZ    R0,?C0224
0033 F4                CPL     A
0034 FD                MOV     R5,A
0035 900000      R     MOV     DPTR,#en_rxaddr
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 45  

0038 E0                MOVX    A,@DPTR
0039 5D                ANL     A,R5
003A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 358
003B A3                INC     DPTR
003C E0                MOVX    A,@DPTR
003D 5D                ANL     A,R5
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 359
003F 8007              SJMP    ?C0041
                                           ; SOURCE LINE # 361
0041         ?C0048:
                                           ; SOURCE LINE # 362
0041 E4                CLR     A
0042 900000      R     MOV     DPTR,#en_rxaddr
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 363
0046 A3                INC     DPTR
0047 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 364
                                           ; SOURCE LINE # 366
                                           ; SOURCE LINE # 367
                                           ; SOURCE LINE # 368
0048         ?C0041:
                                           ; SOURCE LINE # 370
0048 900000      R     MOV     DPTR,#en_rxaddr
004B E0                MOVX    A,@DPTR
004C FD                MOV     R5,A
004D 7F02              MOV     R7,#02H
004F 120000      R     LCALL   _hal_nrf_write_reg
                                           ; SOURCE LINE # 371
0052 900000      R     MOV     DPTR,#en_aa
0055 E0                MOVX    A,@DPTR
0056 FD                MOV     R5,A
0057 7F01              MOV     R7,#01H
0059 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_close_pipe (END)

             ; FUNCTION _hal_nrf_set_address (BEGIN)
                                           ; SOURCE LINE # 374
0000 900000      R     MOV     DPTR,#addr
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
000B 900000      R     MOV     DPTR,#address
000E EF                MOV     A,R7
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
0010 14                DEC     A
0011 600A              JZ      ?C0054
0013 24FB              ADD     A,#0FBH
0015 501A              JNC     ?C0058
0017 6004              JZ      ?C0054
0019 2406              ADD     A,#06H
001B 702B              JNZ     ?C0060
                                           ; SOURCE LINE # 377
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 46  

                                           ; SOURCE LINE # 378
                                           ; SOURCE LINE # 379
                                           ; SOURCE LINE # 380
001D         ?C0054:
                                           ; SOURCE LINE # 381
001D 120000      R     LCALL   hal_nrf_get_address_width
0020 AB07              MOV     R3,AR7
0022 900000      R     MOV     DPTR,#address
0025 E0                MOVX    A,@DPTR
0026 242A              ADD     A,#02AH
0028 FF                MOV     R7,A
0029 A3                INC     DPTR
002A A3                INC     DPTR
002B A3                INC     DPTR
002C E0                MOVX    A,@DPTR
002D FD                MOV     R5,A
002E 020000      R     LJMP    _hal_nrf_write_multibyte_reg
                                           ; SOURCE LINE # 382
                                           ; SOURCE LINE # 383
                                           ; SOURCE LINE # 384
                                           ; SOURCE LINE # 385
                                           ; SOURCE LINE # 386
0031         ?C0058:
                                           ; SOURCE LINE # 387
0031 900000      R     MOV     DPTR,#address
0034 E0                MOVX    A,@DPTR
0035 240A              ADD     A,#0AH
0037 FF                MOV     R7,A
0038 A3                INC     DPTR
0039 E0                MOVX    A,@DPTR
003A FB                MOV     R3,A
003B A3                INC     DPTR
003C E0                MOVX    A,@DPTR
003D FA                MOV     R2,A
003E A3                INC     DPTR
003F E0                MOVX    A,@DPTR
0040 F9                MOV     R1,A
0041 120000      E     LCALL   ?C?CLDPTR
0044 FD                MOV     R5,A
0045 120000      R     LCALL   _hal_nrf_write_reg
                                           ; SOURCE LINE # 388
                                           ; SOURCE LINE # 390
                                           ; SOURCE LINE # 391
                                           ; SOURCE LINE # 392
                                           ; SOURCE LINE # 393
0048         ?C0060:
0048 22                RET     
             ; FUNCTION _hal_nrf_set_address (END)

             ; FUNCTION _hal_nrf_get_address (BEGIN)
                                           ; SOURCE LINE # 395
0000 900000      R     MOV     DPTR,#addr
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
000B 900000      R     MOV     DPTR,#address
000E EF                MOV     A,R7
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 47  

000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 396
                                           ; SOURCE LINE # 397
0010 14                DEC     A
0011 6008              JZ      ?C0064
0013 24FB              ADD     A,#0FBH
0015 6004              JZ      ?C0064
0017 2406              ADD     A,#06H
0019 700D              JNZ     ?C0066
                                           ; SOURCE LINE # 398
                                           ; SOURCE LINE # 399
                                           ; SOURCE LINE # 400
                                           ; SOURCE LINE # 401
001B         ?C0064:
                                           ; SOURCE LINE # 402
001B 900000      R     MOV     DPTR,#address
001E E0                MOVX    A,@DPTR
001F FF                MOV     R7,A
0020 A3                INC     DPTR
0021 A3                INC     DPTR
0022 A3                INC     DPTR
0023 E0                MOVX    A,@DPTR
0024 FD                MOV     R5,A
0025 020000      R     LJMP    _hal_nrf_read_multibyte_reg
                                           ; SOURCE LINE # 403
0028         ?C0066:
                                           ; SOURCE LINE # 404
0028 900000      R     MOV     DPTR,#address
002B E0                MOVX    A,@DPTR
002C 240A              ADD     A,#0AH
002E FF                MOV     R7,A
002F 120000      R     LCALL   _hal_nrf_read_reg
0032 900000      R     MOV     DPTR,#addr
0035 E0                MOVX    A,@DPTR
0036 FB                MOV     R3,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FA                MOV     R2,A
003A A3                INC     DPTR
003B E0                MOVX    A,@DPTR
003C F9                MOV     R1,A
003D EF                MOV     A,R7
003E 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 405
0041 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 406
                                           ; SOURCE LINE # 407
0043         ?C0065:
0043 22                RET     
             ; FUNCTION _hal_nrf_get_address (END)

             ; FUNCTION _hal_nrf_set_auto_retr (BEGIN)
                                           ; SOURCE LINE # 409
;---- Variable 'delay' assigned to Register 'R4/R5' ----
;---- Variable 'retr' assigned to Register 'R3' ----
0000 AB07              MOV     R3,AR7
                                           ; SOURCE LINE # 410
                                           ; SOURCE LINE # 412
0002 AE04              MOV     R6,AR4
0004 AF05              MOV     R7,AR5
0006 7C00              MOV     R4,#00H
0008 7DFA              MOV     R5,#0FAH
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 48  

000A 120000      E     LCALL   ?C?UIDIV
000D EF                MOV     A,R7
000E 14                DEC     A
000F 540F              ANL     A,#0FH
0011 C4                SWAP    A
0012 54F0              ANL     A,#0F0H
0014 FF                MOV     R7,A
0015 900000      R     MOV     DPTR,#setup_retr
0018 E0                MOVX    A,@DPTR
0019 540F              ANL     A,#0FH
001B 4F                ORL     A,R7
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 413
001D EB                MOV     A,R3
001E 540F              ANL     A,#0FH
0020 FF                MOV     R7,A
0021 E0                MOVX    A,@DPTR
0022 54F0              ANL     A,#0F0H
0024 4F                ORL     A,R7
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 415
0026 E0                MOVX    A,@DPTR
0027 FD                MOV     R5,A
0028 7F04              MOV     R7,#04H
002A 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_auto_retr (END)

             ; FUNCTION _hal_nrf_set_address_width (BEGIN)
                                           ; SOURCE LINE # 418
;---- Variable 'aw' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 419
                                           ; SOURCE LINE # 421
0000 EF                MOV     A,R7
0001 24FE              ADD     A,#0FEH
0003 5403              ANL     A,#03H
0005 FF                MOV     R7,A
0006 900000      R     MOV     DPTR,#setup_aw
0009 E0                MOVX    A,@DPTR
000A 54FC              ANL     A,#0FCH
000C 4F                ORL     A,R7
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 423
000E E0                MOVX    A,@DPTR
000F FD                MOV     R5,A
0010 7F03              MOV     R7,#03H
0012 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_address_width (END)

             ; FUNCTION hal_nrf_get_address_width (BEGIN)
                                           ; SOURCE LINE # 426
                                           ; SOURCE LINE # 427
                                           ; SOURCE LINE # 428
0000 7F03              MOV     R7,#03H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 2402              ADD     A,#02H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 429
0009         ?C0069:
0009 22                RET     
             ; FUNCTION hal_nrf_get_address_width (END)

C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 49  

             ; FUNCTION _hal_nrf_set_rx_payload_width (BEGIN)
                                           ; SOURCE LINE # 431
;---- Variable 'pload_width' assigned to Register 'R5' ----
;---- Variable 'pipe_num' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 432
                                           ; SOURCE LINE # 433
0000 EF                MOV     A,R7
0001 2411              ADD     A,#011H
0003 FF                MOV     R7,A
0004 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_rx_payload_width (END)

             ; FUNCTION _hal_nrf_get_pipe_status (BEGIN)
                                           ; SOURCE LINE # 436
0000 900000      R     MOV     DPTR,#pipe_num
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 437
                                           ; SOURCE LINE # 442
0005 7F02              MOV     R7,#02H
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#en_rxaddr
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 443
000F 7F01              MOV     R7,#01H
0011 120000      R     LCALL   _hal_nrf_read_reg
0014 900000      R     MOV     DPTR,#en_aa
0017 EF                MOV     A,R7
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 445
0019 900000      R     MOV     DPTR,#pipe_num
001C E0                MOVX    A,@DPTR
001D 14                DEC     A
001E 6020              JZ      ?C0073
0020 14                DEC     A
0021 6031              JZ      ?C0074
0023 14                DEC     A
0024 6042              JZ      ?C0075
0026 14                DEC     A
0027 6055              JZ      ?C0076
0029 14                DEC     A
002A 6064              JZ      ?C0077
002C 2405              ADD     A,#05H
002E 707A              JNZ     ?C0078
                                           ; SOURCE LINE # 446
                                           ; SOURCE LINE # 447
0030         ?C0072:
                                           ; SOURCE LINE # 448
0030 900000      R     MOV     DPTR,#en_rxaddr
0033 E0                MOVX    A,@DPTR
0034 5401              ANL     A,#01H
0036 900000      R     MOV     DPTR,#en_rx_r
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 449
003A 900000      R     MOV     DPTR,#en_aa
003D E0                MOVX    A,@DPTR
                                           ; SOURCE LINE # 450
003E 8062              SJMP    ?C0230
                                           ; SOURCE LINE # 451
0040         ?C0073:
                                           ; SOURCE LINE # 452
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 50  

0040 900000      R     MOV     DPTR,#en_rxaddr
0043 E0                MOVX    A,@DPTR
0044 C3                CLR     C
0045 13                RRC     A
0046 5401              ANL     A,#01H
0048 900000      R     MOV     DPTR,#en_rx_r
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 453
004C 900000      R     MOV     DPTR,#en_aa
004F E0                MOVX    A,@DPTR
0050 C3                CLR     C
0051 13                RRC     A
0052         ?C0226:
                                           ; SOURCE LINE # 454
0052 804E              SJMP    ?C0230
                                           ; SOURCE LINE # 455
0054         ?C0074:
                                           ; SOURCE LINE # 456
0054 900000      R     MOV     DPTR,#en_rxaddr
0057 E0                MOVX    A,@DPTR
0058 13                RRC     A
0059 13                RRC     A
005A 5401              ANL     A,#01H
005C 900000      R     MOV     DPTR,#en_rx_r
005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 457
0060 900000      R     MOV     DPTR,#en_aa
0063 E0                MOVX    A,@DPTR
0064 13                RRC     A
0065 13                RRC     A
0066         ?C0227:
                                           ; SOURCE LINE # 458
0066 803A              SJMP    ?C0230
                                           ; SOURCE LINE # 459
0068         ?C0075:
                                           ; SOURCE LINE # 460
0068 900000      R     MOV     DPTR,#en_rxaddr
006B E0                MOVX    A,@DPTR
006C 13                RRC     A
006D 13                RRC     A
006E 13                RRC     A
006F 5401              ANL     A,#01H
0071 900000      R     MOV     DPTR,#en_rx_r
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 461
0075 900000      R     MOV     DPTR,#en_aa
0078 E0                MOVX    A,@DPTR
0079 13                RRC     A
007A 13                RRC     A
007B 13                RRC     A
007C         ?C0228:
                                           ; SOURCE LINE # 462
007C 8024              SJMP    ?C0230
                                           ; SOURCE LINE # 463
007E         ?C0076:
                                           ; SOURCE LINE # 464
007E 900000      R     MOV     DPTR,#en_rxaddr
0081 E0                MOVX    A,@DPTR
0082 C4                SWAP    A
0083 5401              ANL     A,#01H
0085 900000      R     MOV     DPTR,#en_rx_r
0088 F0                MOVX    @DPTR,A
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 51  

                                           ; SOURCE LINE # 465
0089 900000      R     MOV     DPTR,#en_aa
008C E0                MOVX    A,@DPTR
008D C4                SWAP    A
008E         ?C0229:
                                           ; SOURCE LINE # 466
008E 8012              SJMP    ?C0230
                                           ; SOURCE LINE # 467
0090         ?C0077:
                                           ; SOURCE LINE # 468
0090 900000      R     MOV     DPTR,#en_rxaddr
0093 E0                MOVX    A,@DPTR
0094 C4                SWAP    A
0095 13                RRC     A
0096 5401              ANL     A,#01H
0098 900000      R     MOV     DPTR,#en_rx_r
009B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 469
009C 900000      R     MOV     DPTR,#en_aa
009F E0                MOVX    A,@DPTR
00A0 C4                SWAP    A
00A1 13                RRC     A
00A2         ?C0230:
00A2 5401              ANL     A,#01H
00A4 900000      R     MOV     DPTR,#en_aa_r
00A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 470
00A8 8007              SJMP    ?C0071
                                           ; SOURCE LINE # 471
00AA         ?C0078:
                                           ; SOURCE LINE # 472
00AA E4                CLR     A
00AB 900000      R     MOV     DPTR,#en_rx_r
00AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 473
00AF A3                INC     DPTR
00B0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 474
                                           ; SOURCE LINE # 475
00B1         ?C0071:
                                           ; SOURCE LINE # 477
00B1 900000      R     MOV     DPTR,#en_aa_r
00B4 E0                MOVX    A,@DPTR
00B5 25E0              ADD     A,ACC
00B7 FF                MOV     R7,A
00B8 900000      R     MOV     DPTR,#en_rx_r
00BB E0                MOVX    A,@DPTR
00BC 2F                ADD     A,R7
00BD FF                MOV     R7,A
                                           ; SOURCE LINE # 478
00BE         ?C0079:
00BE 22                RET     
             ; FUNCTION _hal_nrf_get_pipe_status (END)

             ; FUNCTION hal_nrf_get_auto_retr_status (BEGIN)
                                           ; SOURCE LINE # 480
                                           ; SOURCE LINE # 481
                                           ; SOURCE LINE # 482
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_reg
                                           ; SOURCE LINE # 483
0005         ?C0080:
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 52  

0005 22                RET     
             ; FUNCTION hal_nrf_get_auto_retr_status (END)

             ; FUNCTION hal_nrf_get_packet_lost_ctr (BEGIN)
                                           ; SOURCE LINE # 485
                                           ; SOURCE LINE # 486
                                           ; SOURCE LINE # 487
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 54F0              ANL     A,#0F0H
0008 C4                SWAP    A
0009 540F              ANL     A,#0FH
000B FF                MOV     R7,A
                                           ; SOURCE LINE # 488
000C         ?C0081:
000C 22                RET     
             ; FUNCTION hal_nrf_get_packet_lost_ctr (END)

             ; FUNCTION _hal_nrf_get_rx_payload_width (BEGIN)
                                           ; SOURCE LINE # 490
;---- Variable 'pipe_num' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 491
                                           ; SOURCE LINE # 494
0000 EF                MOV     A,R7
0001 14                DEC     A
0002 6014              JZ      ?C0084
0004 14                DEC     A
0005 6015              JZ      ?C0085
0007 14                DEC     A
0008 6016              JZ      ?C0086
000A 14                DEC     A
000B 6017              JZ      ?C0087
000D 14                DEC     A
000E 6018              JZ      ?C0088
0010 2405              ADD     A,#05H
0012 7020              JNZ     ?C0089
                                           ; SOURCE LINE # 495
                                           ; SOURCE LINE # 496
0014         ?C0083:
                                           ; SOURCE LINE # 497
0014 7F11              MOV     R7,#011H
                                           ; SOURCE LINE # 498
0016 8012              SJMP    ?C0235
                                           ; SOURCE LINE # 499
0018         ?C0084:
                                           ; SOURCE LINE # 500
0018 7F12              MOV     R7,#012H
001A         ?C0231:
                                           ; SOURCE LINE # 501
001A 800E              SJMP    ?C0235
                                           ; SOURCE LINE # 502
001C         ?C0085:
                                           ; SOURCE LINE # 503
001C 7F13              MOV     R7,#013H
001E         ?C0232:
                                           ; SOURCE LINE # 504
001E 800A              SJMP    ?C0235
                                           ; SOURCE LINE # 505
0020         ?C0086:
                                           ; SOURCE LINE # 506
0020 7F14              MOV     R7,#014H
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 53  

0022         ?C0233:
                                           ; SOURCE LINE # 507
0022 8006              SJMP    ?C0235
                                           ; SOURCE LINE # 508
0024         ?C0087:
                                           ; SOURCE LINE # 509
0024 7F15              MOV     R7,#015H
0026         ?C0234:
                                           ; SOURCE LINE # 510
0026 8002              SJMP    ?C0235
                                           ; SOURCE LINE # 511
0028         ?C0088:
                                           ; SOURCE LINE # 512
0028 7F16              MOV     R7,#016H
002A         ?C0235:
002A 120000      R     LCALL   _hal_nrf_read_reg
002D 900000      R     MOV     DPTR,#pw
0030 EF                MOV     A,R7
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 513
0032 8005              SJMP    ?C0082
                                           ; SOURCE LINE # 514
0034         ?C0089:
                                           ; SOURCE LINE # 515
0034 E4                CLR     A
0035 900000      R     MOV     DPTR,#pw
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 516
                                           ; SOURCE LINE # 517
0039         ?C0082:
                                           ; SOURCE LINE # 519
0039 900000      R     MOV     DPTR,#pw
003C E0                MOVX    A,@DPTR
003D FF                MOV     R7,A
                                           ; SOURCE LINE # 520
003E         ?C0090:
003E 22                RET     
             ; FUNCTION _hal_nrf_get_rx_payload_width (END)

             ; FUNCTION _hal_nrf_set_rf_channel (BEGIN)
                                           ; SOURCE LINE # 522
;---- Variable 'channel' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 523
                                           ; SOURCE LINE # 525
0000 EF                MOV     A,R7
0001 547F              ANL     A,#07FH
0003 FF                MOV     R7,A
0004 900000      R     MOV     DPTR,#rf_ch
0007 E0                MOVX    A,@DPTR
0008 5480              ANL     A,#080H
000A 4F                ORL     A,R7
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 527
000C E0                MOVX    A,@DPTR
000D FD                MOV     R5,A
000E 7F05              MOV     R7,#05H
0010 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_rf_channel (END)

             ; FUNCTION _hal_nrf_set_output_power (BEGIN)
                                           ; SOURCE LINE # 530
0000 900000      R     MOV     DPTR,#power
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 54  

                                           ; SOURCE LINE # 531
                                           ; SOURCE LINE # 533
0003 120000      R     LCALL   L?0239
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 535
000B 900000      R     MOV     DPTR,#power
000E E0                MOVX    A,@DPTR
000F 5403              ANL     A,#03H
0011 25E0              ADD     A,ACC
0013 FF                MOV     R7,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 54F9              ANL     A,#0F9H
0018 4F                ORL     A,R7
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 537
001A E0                MOVX    A,@DPTR
001B FD                MOV     R5,A
001C 7F06              MOV     R7,#06H
001E 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_output_power (END)

             ; FUNCTION _hal_nrf_set_datarate (BEGIN)
                                           ; SOURCE LINE # 540
0000 900000      R     MOV     DPTR,#datarate
                                           ; SOURCE LINE # 541
                                           ; SOURCE LINE # 543
0003 120000      R     LCALL   L?0239
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 545
000B 900000      R     MOV     DPTR,#datarate
000E E0                MOVX    A,@DPTR
000F 600C              JZ      ?C0095
0011 24FE              ADD     A,#0FEH
0013 7015              JNZ     ?C0097
                                           ; SOURCE LINE # 546
                                           ; SOURCE LINE # 547
0015         ?C0094:
                                           ; SOURCE LINE # 548
0015 900000      R     MOV     DPTR,#rf_setup
0018 E0                MOVX    A,@DPTR
0019 4420              ORL     A,#020H
                                           ; SOURCE LINE # 549
                                           ; SOURCE LINE # 550
001B 8006              SJMP    ?C0236
                                           ; SOURCE LINE # 551
001D         ?C0095:
                                           ; SOURCE LINE # 552
001D 900000      R     MOV     DPTR,#rf_setup
0020 E0                MOVX    A,@DPTR
0021 54DF              ANL     A,#0DFH
0023         ?C0236:
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 553
0024 E0                MOVX    A,@DPTR
0025 54F7              ANL     A,#0F7H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 554
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 55  

0028 800B              SJMP    ?C0093
                                           ; SOURCE LINE # 555
                                           ; SOURCE LINE # 556
002A         ?C0097:
                                           ; SOURCE LINE # 557
002A 900000      R     MOV     DPTR,#rf_setup
002D E0                MOVX    A,@DPTR
002E 54DF              ANL     A,#0DFH
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 558
0031 E0                MOVX    A,@DPTR
0032 4408              ORL     A,#08H
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 559
                                           ; SOURCE LINE # 560
0035         ?C0093:
                                           ; SOURCE LINE # 562
0035 900000      R     MOV     DPTR,#rf_setup
0038 E0                MOVX    A,@DPTR
0039 FD                MOV     R5,A
003A 7F06              MOV     R7,#06H
003C 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_datarate (END)

             ; FUNCTION hal_nrf_rx_fifo_empty (BEGIN)
                                           ; SOURCE LINE # 565
                                           ; SOURCE LINE # 566
                                           ; SOURCE LINE # 567
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5401              ANL     A,#01H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 568
0009         ?C0099:
0009 22                RET     
             ; FUNCTION hal_nrf_rx_fifo_empty (END)

             ; FUNCTION hal_nrf_rx_fifo_full (BEGIN)
                                           ; SOURCE LINE # 570
                                           ; SOURCE LINE # 571
                                           ; SOURCE LINE # 572
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 C3                CLR     C
0007 13                RRC     A
0008 5401              ANL     A,#01H
000A FF                MOV     R7,A
                                           ; SOURCE LINE # 573
000B         ?C0100:
000B 22                RET     
             ; FUNCTION hal_nrf_rx_fifo_full (END)

             ; FUNCTION hal_nrf_tx_fifo_empty (BEGIN)
                                           ; SOURCE LINE # 575
                                           ; SOURCE LINE # 576
                                           ; SOURCE LINE # 577
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 C4                SWAP    A
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 56  

0007 5401              ANL     A,#01H
0009 FF                MOV     R7,A
                                           ; SOURCE LINE # 578
000A         ?C0101:
000A 22                RET     
             ; FUNCTION hal_nrf_tx_fifo_empty (END)

             ; FUNCTION hal_nrf_tx_fifo_full (BEGIN)
                                           ; SOURCE LINE # 580
                                           ; SOURCE LINE # 581
                                           ; SOURCE LINE # 582
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 C4                SWAP    A
0007 13                RRC     A
0008 5401              ANL     A,#01H
000A FF                MOV     R7,A
                                           ; SOURCE LINE # 583
000B         ?C0102:
000B 22                RET     
             ; FUNCTION hal_nrf_tx_fifo_full (END)

             ; FUNCTION hal_nrf_get_tx_fifo_status (BEGIN)
                                           ; SOURCE LINE # 585
                                           ; SOURCE LINE # 586
                                           ; SOURCE LINE # 587
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5430              ANL     A,#030H
0008 C4                SWAP    A
0009 540F              ANL     A,#0FH
000B FF                MOV     R7,A
                                           ; SOURCE LINE # 588
000C         ?C0103:
000C 22                RET     
             ; FUNCTION hal_nrf_get_tx_fifo_status (END)

             ; FUNCTION hal_nrf_get_rx_fifo_status (BEGIN)
                                           ; SOURCE LINE # 590
                                           ; SOURCE LINE # 591
                                           ; SOURCE LINE # 592
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5403              ANL     A,#03H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 593
0009         ?C0104:
0009 22                RET     
             ; FUNCTION hal_nrf_get_rx_fifo_status (END)

             ; FUNCTION hal_nrf_get_fifo_status (BEGIN)
                                           ; SOURCE LINE # 595
                                           ; SOURCE LINE # 596
                                           ; SOURCE LINE # 597
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
                                           ; SOURCE LINE # 598
0005         ?C0105:
0005 22                RET     
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 57  

             ; FUNCTION hal_nrf_get_fifo_status (END)

             ; FUNCTION hal_nrf_get_transmit_attempts (BEGIN)
                                           ; SOURCE LINE # 600
                                           ; SOURCE LINE # 601
                                           ; SOURCE LINE # 602
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 540F              ANL     A,#0FH
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 603
0009         ?C0106:
0009 22                RET     
             ; FUNCTION hal_nrf_get_transmit_attempts (END)

             ; FUNCTION hal_nrf_get_carrier_detect (BEGIN)
                                           ; SOURCE LINE # 605
                                           ; SOURCE LINE # 606
                                           ; SOURCE LINE # 607
0000 7F09              MOV     R7,#09H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5401              ANL     A,#01H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 608
0009         ?C0107:
0009 22                RET     
             ; FUNCTION hal_nrf_get_carrier_detect (END)

             ; FUNCTION hal_nrf_activate_features (BEGIN)
                                           ; SOURCE LINE # 610
                                           ; SOURCE LINE # 611
0000         ?C0108:
0000 22                RET     
             ; FUNCTION hal_nrf_activate_features (END)

             ; FUNCTION _hal_nrf_setup_dynamic_payload (BEGIN)
                                           ; SOURCE LINE # 613
;---- Variable 'setup' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 614
                                           ; SOURCE LINE # 616
0000 EF                MOV     A,R7
0001 543F              ANL     A,#03FH
0003 900000      R     MOV     DPTR,#dynpd
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 618
0007 E0                MOVX    A,@DPTR
0008 FD                MOV     R5,A
0009 7F1C              MOV     R7,#01CH
000B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_setup_dynamic_payload (END)

             ; FUNCTION _hal_nrf_enable_dynamic_payload (BEGIN)
                                           ; SOURCE LINE # 621
0000 900000      R     MOV     DPTR,#enable
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 622
                                           ; SOURCE LINE # 624
0005 7F1D              MOV     R7,#01DH
0007 120000      R     LCALL   _hal_nrf_read_reg
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 58  

000A 900000      R     MOV     DPTR,#feature
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 625
000F 900000      R     MOV     DPTR,#enable
0012 E0                MOVX    A,@DPTR
0013 6004              JZ      ?C0110
0015 7F01              MOV     R7,#01H
0017 8002              SJMP    ?C0111
0019         ?C0110:
0019 7F00              MOV     R7,#00H
001B         ?C0111:
001B EF                MOV     A,R7
001C 5401              ANL     A,#01H
001E 25E0              ADD     A,ACC
0020 25E0              ADD     A,ACC
0022 FF                MOV     R7,A
0023 900000      R     MOV     DPTR,#feature
0026 E0                MOVX    A,@DPTR
0027 54FB              ANL     A,#0FBH
0029 4F                ORL     A,R7
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 627
002B E0                MOVX    A,@DPTR
002C FD                MOV     R5,A
002D 7F1D              MOV     R7,#01DH
002F 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_dynamic_payload (END)

             ; FUNCTION _hal_nrf_enable_ack_payload (BEGIN)
                                           ; SOURCE LINE # 630
0000 900000      R     MOV     DPTR,#enable
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 631
                                           ; SOURCE LINE # 633
0005 7F1D              MOV     R7,#01DH
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#feature
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 634
000F 900000      R     MOV     DPTR,#enable
0012 E0                MOVX    A,@DPTR
0013 6004              JZ      ?C0113
0015 7F01              MOV     R7,#01H
0017 8002              SJMP    ?C0114
0019         ?C0113:
0019 7F00              MOV     R7,#00H
001B         ?C0114:
001B EF                MOV     A,R7
001C 5401              ANL     A,#01H
001E 25E0              ADD     A,ACC
0020 FF                MOV     R7,A
0021 900000      R     MOV     DPTR,#feature
0024 E0                MOVX    A,@DPTR
0025 54FD              ANL     A,#0FDH
0027 4F                ORL     A,R7
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 636
0029 E0                MOVX    A,@DPTR
002A FD                MOV     R5,A
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 59  

002B 7F1D              MOV     R7,#01DH
002D 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_ack_payload (END)

             ; FUNCTION _hal_nrf_enable_dynamic_ack (BEGIN)
                                           ; SOURCE LINE # 639
0000 900000      R     MOV     DPTR,#enable
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 640
                                           ; SOURCE LINE # 642
0005 7F1D              MOV     R7,#01DH
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#feature
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 643
000F 900000      R     MOV     DPTR,#enable
0012 E0                MOVX    A,@DPTR
0013 6004              JZ      ?C0116
0015 7F01              MOV     R7,#01H
0017 8002              SJMP    ?C0117
0019         ?C0116:
0019 7F00              MOV     R7,#00H
001B         ?C0117:
001B EF                MOV     A,R7
001C 5401              ANL     A,#01H
001E FF                MOV     R7,A
001F 900000      R     MOV     DPTR,#feature
0022 E0                MOVX    A,@DPTR
0023 54FE              ANL     A,#0FEH
0025 4F                ORL     A,R7
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 645
0027 E0                MOVX    A,@DPTR
0028 FD                MOV     R5,A
0029 7F1D              MOV     R7,#01DH
002B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_dynamic_ack (END)

             ; FUNCTION _hal_nrf_write_tx_payload (BEGIN)
                                           ; SOURCE LINE # 648
;---- Variable 'length' assigned to Register 'R6' ----
0000 AE05              MOV     R6,AR5
;---- Variable 'tx_pload' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 649
                                           ; SOURCE LINE # 650
0002 AD07              MOV     R5,AR7
0004 AF06              MOV     R7,AR6
0006 AB07              MOV     R3,AR7
0008 7FA0              MOV     R7,#0A0H
000A 020000      R     LJMP    _hal_nrf_write_multibyte_reg
             ; FUNCTION _hal_nrf_write_tx_payload (END)

             ; FUNCTION _hal_nrf_write_tx_payload_noack (BEGIN)
                                           ; SOURCE LINE # 653
;---- Variable 'length' assigned to Register 'R6' ----
0000 AE05              MOV     R6,AR5
;---- Variable 'tx_pload' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 654
                                           ; SOURCE LINE # 655
0002 AD07              MOV     R5,AR7
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 60  

0004 AF06              MOV     R7,AR6
0006 AB07              MOV     R3,AR7
0008 7FB0              MOV     R7,#0B0H
000A 020000      R     LJMP    _hal_nrf_write_multibyte_reg
             ; FUNCTION _hal_nrf_write_tx_payload_noack (END)

             ; FUNCTION _hal_nrf_write_ack_payload (BEGIN)
                                           ; SOURCE LINE # 658
;---- Variable 'pipe' assigned to Register 'R7' ----
;---- Variable 'length' assigned to Register 'R3' ----
;---- Variable 'tx_pload' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 659
                                           ; SOURCE LINE # 660
0000 EF                MOV     A,R7
0001 44A8              ORL     A,#0A8H
0003 FF                MOV     R7,A
0004 020000      R     LJMP    _hal_nrf_write_multibyte_reg
             ; FUNCTION _hal_nrf_write_ack_payload (END)

             ; FUNCTION hal_nrf_read_rx_payload_width (BEGIN)
                                           ; SOURCE LINE # 663
                                           ; SOURCE LINE # 664
                                           ; SOURCE LINE # 665
0000 7F60              MOV     R7,#060H
0002 120000      R     LCALL   _hal_nrf_read_reg
                                           ; SOURCE LINE # 666
0005         ?C0122:
0005 22                RET     
             ; FUNCTION hal_nrf_read_rx_payload_width (END)

             ; FUNCTION _hal_nrf_read_rx_payload (BEGIN)
                                           ; SOURCE LINE # 668
;---- Variable 'rx_pload' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 669
                                           ; SOURCE LINE # 670
0000 AD07              MOV     R5,AR7
0002 7F08              MOV     R7,#08H
0004 120000      R     LCALL   _hal_nrf_read_multibyte_reg
                                           ; SOURCE LINE # 671
0007         ?C0123:
0007 22                RET     
             ; FUNCTION _hal_nrf_read_rx_payload (END)

             ; FUNCTION hal_nrf_get_rx_data_source (BEGIN)
                                           ; SOURCE LINE # 673
                                           ; SOURCE LINE # 674
                                           ; SOURCE LINE # 675
0000 120000      R     LCALL   hal_nrf_nop
0003 EF                MOV     A,R7
0004 540E              ANL     A,#0EH
0006 C3                CLR     C
0007 13                RRC     A
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 676
0009         ?C0124:
0009 22                RET     
             ; FUNCTION hal_nrf_get_rx_data_source (END)

             ; FUNCTION hal_nrf_reuse_tx (BEGIN)
                                           ; SOURCE LINE # 678
                                           ; SOURCE LINE # 679
                                           ; SOURCE LINE # 680
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 61  

0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 681
0002 7FE3              MOV     R7,#0E3H
0004 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 682
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 683
0009 22                RET     
             ; FUNCTION hal_nrf_reuse_tx (END)

             ; FUNCTION hal_nrf_get_reuse_tx_status (BEGIN)
                                           ; SOURCE LINE # 685
                                           ; SOURCE LINE # 686
                                           ; SOURCE LINE # 687
0000 120000      R     LCALL   hal_nrf_get_fifo_status
0003 EF                MOV     A,R7
0004 5440              ANL     A,#040H
0006 C4                SWAP    A
0007 13                RRC     A
0008 13                RRC     A
0009 5403              ANL     A,#03H
000B FF                MOV     R7,A
                                           ; SOURCE LINE # 688
000C         ?C0132:
000C 22                RET     
             ; FUNCTION hal_nrf_get_reuse_tx_status (END)

             ; FUNCTION hal_nrf_flush_rx (BEGIN)
                                           ; SOURCE LINE # 690
                                           ; SOURCE LINE # 691
                                           ; SOURCE LINE # 692
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 693
0002 7FE2              MOV     R7,#0E2H
0004 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 694
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 695
0009 22                RET     
             ; FUNCTION hal_nrf_flush_rx (END)

             ; FUNCTION hal_nrf_flush_tx (BEGIN)
                                           ; SOURCE LINE # 697
                                           ; SOURCE LINE # 698
                                           ; SOURCE LINE # 699
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 700
0002 7FE1              MOV     R7,#0E1H
0004 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 701
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 702
0009 22                RET     
             ; FUNCTION hal_nrf_flush_tx (END)

             ; FUNCTION hal_nrf_nop (BEGIN)
                                           ; SOURCE LINE # 704
                                           ; SOURCE LINE # 705
                                           ; SOURCE LINE # 708
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 709
0002 7FFF              MOV     R7,#0FFH
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 62  

0004 120000      E     LCALL   _hal_nrf_rw
;---- Variable 'retval' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 710
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 712
                                           ; SOURCE LINE # 713
0009         ?C0153:
0009 22                RET     
             ; FUNCTION hal_nrf_nop (END)

             ; FUNCTION _hal_nrf_set_pll_mode (BEGIN)
                                           ; SOURCE LINE # 715
0000 900000      R     MOV     DPTR,#pll_lock
                                           ; SOURCE LINE # 716
                                           ; SOURCE LINE # 718
0003 120000      R     LCALL   L?0240
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 719
000B 900000      R     MOV     DPTR,#pll_lock
000E E0                MOVX    A,@DPTR
000F 6004              JZ      ?C0154
0011 7F01              MOV     R7,#01H
0013 8002              SJMP    ?C0155
0015         ?C0154:
0015 7F00              MOV     R7,#00H
0017         ?C0155:
0017 EF                MOV     A,R7
0018 5401              ANL     A,#01H
001A C4                SWAP    A
001B 54F0              ANL     A,#0F0H
001D FF                MOV     R7,A
001E 900000      R     MOV     DPTR,#rf_setup
0021 E0                MOVX    A,@DPTR
0022 54EF              ANL     A,#0EFH
0024 4F                ORL     A,R7
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 721
0026 E0                MOVX    A,@DPTR
0027 FD                MOV     R5,A
0028 7F06              MOV     R7,#06H
002A 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_pll_mode (END)

             ; FUNCTION _hal_nrf_enable_continious_wave (BEGIN)
                                           ; SOURCE LINE # 724
0000 900000      R     MOV     DPTR,#enable
                                           ; SOURCE LINE # 725
                                           ; SOURCE LINE # 727
0003 120000      R     LCALL   L?0240
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 728
000B 900000      R     MOV     DPTR,#enable
000E E0                MOVX    A,@DPTR
000F 6004              JZ      ?C0157
0011 7F01              MOV     R7,#01H
0013 8002              SJMP    ?C0158
0015         ?C0157:
0015 7F00              MOV     R7,#00H
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 63  

0017         ?C0158:
0017 EF                MOV     A,R7
0018 5401              ANL     A,#01H
001A C4                SWAP    A
001B 33                RLC     A
001C 33                RLC     A
001D 33                RLC     A
001E 5480              ANL     A,#080H
0020 FF                MOV     R7,A
0021 900000      R     MOV     DPTR,#rf_setup
0024 E0                MOVX    A,@DPTR
0025 547F              ANL     A,#07FH
0027 4F                ORL     A,R7
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 730
0029 E0                MOVX    A,@DPTR
002A FD                MOV     R5,A
002B 7F06              MOV     R7,#06H
002D 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_continious_wave (END)

             ; FUNCTION L?0239 (BEGIN)
0000         L?0240:
0000 EF                MOV     A,R7
0001 F0                MOVX    @DPTR,A
0002 7F06              MOV     R7,#06H
             ; FUNCTION _hal_nrf_read_reg (BEGIN)
                                           ; SOURCE LINE # 733
;---- Variable 'reg' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 734
                                           ; SOURCE LINE # 737
0004 C291              CLR     RFCSN
                                           ; SOURCE LINE # 738
0006 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 739
0009 E4                CLR     A
000A FF                MOV     R7,A
000B 120000      E     LCALL   _hal_nrf_rw
;---- Variable 'temp' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 740
000E D291              SETB    RFCSN
                                           ; SOURCE LINE # 742
                                           ; SOURCE LINE # 743
0010         ?C0166:
0010 22                RET     
             ; FUNCTION _hal_nrf_read_reg (END)

             ; FUNCTION _hal_nrf_write_reg (BEGIN)
                                           ; SOURCE LINE # 745
;---- Variable 'value' assigned to Register 'R5' ----
;---- Variable 'reg' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 746
                                           ; SOURCE LINE # 749
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 752
0002 EF                MOV     A,R7
0003 2420              ADD     A,#020H
0005 F5E5              MOV     RFDAT,A
                                           ; SOURCE LINE # 753
0007 C2C0              CLR     RFSPIF
0009         ?C0170:
                                           ; SOURCE LINE # 755
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 64  

0009 30C0FD            JNB     RFSPIF,?C0170
000C         ?C0171:
                                           ; SOURCE LINE # 757
000C 85E500      R     MOV     retval,RFDAT
                                           ; SOURCE LINE # 760
000F AF05              MOV     R7,AR5
0011 8FE5              MOV     RFDAT,R7
                                           ; SOURCE LINE # 761
0013 C2C0              CLR     RFSPIF
0015         ?C0172:
                                           ; SOURCE LINE # 763
0015 30C0FD            JNB     RFSPIF,?C0172
0018         ?C0173:
0018         ?C0176:
                                           ; SOURCE LINE # 768
0018 D291              SETB    RFCSN
                                           ; SOURCE LINE # 770
001A AF00        R     MOV     R7,retval
                                           ; SOURCE LINE # 771
001C         ?C0177:
001C 22                RET     
             ; FUNCTION _hal_nrf_write_reg (END)

             ; FUNCTION _hal_nrf_read_multibyte_reg (BEGIN)
                                           ; SOURCE LINE # 773
0000 900000      R     MOV     DPTR,#pbuf
0003 ED                MOV     A,R5
0004 F0                MOVX    @DPTR,A
0005 900000      R     MOV     DPTR,#reg
0008 EF                MOV     A,R7
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 774
                                           ; SOURCE LINE # 776
000A 14                DEC     A
000B 600C              JZ      ?C0181
000D 24FB              ADD     A,#0FBH
000F 6008              JZ      ?C0181
0011 24FE              ADD     A,#0FEH
0013 6016              JZ      ?C0185
0015 2408              ADD     A,#08H
0017 702F              JNZ     ?C0191
                                           ; SOURCE LINE # 777
                                           ; SOURCE LINE # 778
                                           ; SOURCE LINE # 779
                                           ; SOURCE LINE # 780
0019         ?C0181:
                                           ; SOURCE LINE # 781
0019 120000      R     LCALL   hal_nrf_get_address_width
001C 8F00        R     MOV     ctr,R7
001E 8F00        R     MOV     length,R7
                                           ; SOURCE LINE # 782
0020 C291              CLR     RFCSN
                                           ; SOURCE LINE # 783
0022 900000      R     MOV     DPTR,#reg
0025 E0                MOVX    A,@DPTR
0026 240A              ADD     A,#0AH
0028 FF                MOV     R7,A
                                           ; SOURCE LINE # 784
0029 8018              SJMP    ?C0237
                                           ; SOURCE LINE # 786
002B         ?C0185:
                                           ; SOURCE LINE # 787
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 65  

002B 120000      R     LCALL   hal_nrf_get_rx_data_source
002E 900000      R     MOV     DPTR,#reg
0031 EF                MOV     A,R7
0032 F0                MOVX    @DPTR,A
0033 C3                CLR     C
0034 9407              SUBB    A,#07H
0036 5010              JNC     ?C0238
                                           ; SOURCE LINE # 788
                                           ; SOURCE LINE # 789
0038 120000      R     LCALL   hal_nrf_read_rx_payload_width
003B 8F00        R     MOV     ctr,R7
003D 8F00        R     MOV     length,R7
                                           ; SOURCE LINE # 790
003F C291              CLR     RFCSN
                                           ; SOURCE LINE # 791
0041 7F61              MOV     R7,#061H
0043         ?C0237:
0043 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 792
0046 8005              SJMP    ?C0192
                                           ; SOURCE LINE # 799
0048         ?C0191:
                                           ; SOURCE LINE # 800
0048         ?C0238:
0048 E4                CLR     A
0049 F500        R     MOV     length,A
004B F500        R     MOV     ctr,A
                                           ; SOURCE LINE # 801
                                           ; SOURCE LINE # 802
004D         ?C0192:
                                           ; SOURCE LINE # 804
004D AF00        R     MOV     R7,ctr
004F 1500        R     DEC     ctr
0051 EF                MOV     A,R7
0052 6012              JZ      ?C0196
                                           ; SOURCE LINE # 805
                                           ; SOURCE LINE # 806
0054 E4                CLR     A
0055 FF                MOV     R7,A
0056 120000      E     LCALL   _hal_nrf_rw
0059 900000      R     MOV     DPTR,#pbuf
005C E0                MOVX    A,@DPTR
005D FE                MOV     R6,A
005E 04                INC     A
005F F0                MOVX    @DPTR,A
0060 A806              MOV     R0,AR6
0062 A607              MOV     @R0,AR7
                                           ; SOURCE LINE # 807
0064 80E7              SJMP    ?C0192
0066         ?C0196:
                                           ; SOURCE LINE # 809
0066 D291              SETB    RFCSN
                                           ; SOURCE LINE # 811
0068 900000      R     MOV     DPTR,#reg
006B E0                MOVX    A,@DPTR
006C FE                MOV     R6,A
006D E500        R     MOV     A,length
006F FF                MOV     R7,A
                                           ; SOURCE LINE # 812
0070         ?C0197:
0070 22                RET     
             ; FUNCTION _hal_nrf_read_multibyte_reg (END)
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 66  


             ; FUNCTION _hal_nrf_write_multibyte_reg (BEGIN)
                                           ; SOURCE LINE # 814
;---- Variable 'pbuf' assigned to Register 'R0' ----
0000 A805              MOV     R0,AR5
;---- Variable 'length' assigned to Register 'R3' ----
;---- Variable 'cmd' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 815
                                           ; SOURCE LINE # 818
0002 C291              CLR     RFCSN
                                           ; SOURCE LINE # 820
0004 8FE5              MOV     RFDAT,R7
0006 C2C0              CLR     RFSPIF
                                           ; SOURCE LINE # 822
0008         ?C0204:
0008 EB                MOV     A,R3
0009 D3                SETB    C
000A 9400              SUBB    A,#00H
000C 400F              JC      ?C0212
                                           ; SOURCE LINE # 823
000E         ?C0207:
                                           ; SOURCE LINE # 825
000E 30C0FD            JNB     RFSPIF,?C0207
0011         ?C0208:
                                           ; SOURCE LINE # 827
0011 85E500      R     MOV     dummy,RFDAT
                                           ; SOURCE LINE # 828
0014 E6                MOV     A,@R0
0015 F5E5              MOV     RFDAT,A
0017 C2C0              CLR     RFSPIF
                                           ; SOURCE LINE # 829
0019 1B                DEC     R3
001A 08                INC     R0
001B 80EB              SJMP    ?C0204
001D         ?C0212:
                                           ; SOURCE LINE # 831
001D 30C0FD            JNB     RFSPIF,?C0212
0020         ?C0213:
                                           ; SOURCE LINE # 833
0020 85E500      R     MOV     dummy,RFDAT
                                           ; SOURCE LINE # 834
0023 D291              SETB    RFCSN
                                           ; SOURCE LINE # 835
0025 22                RET     
             ; FUNCTION _hal_nrf_write_multibyte_reg (END)

C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 67  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


hal_nrf_address_t. . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_CRC_16BIT. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
uint16_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
P0 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0080H  1
HAL_NRF_0DBM . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_address_width_t. . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_set_rf_channel. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  channel. . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  rf_ch. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
_hal_nrf_open_pipe . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  auto_ack . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  en_rxaddr. . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
  en_aa. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0003H  1
_hal_nrf_enable_dynamic_ack. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  feature. . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
int32_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
rx_pw_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
HAL_NRF_6DBM . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
int16_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
_hal_nrf_write_tx_payload. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  tx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0007H  1
  length . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0006H  1
hal_nrf_get_clear_irq_flags. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  retval . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
_hal_nrf_enable_ack_payload. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  feature. . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
IEN0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
hal_nrf_nop. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  retval . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
_hal_nrf_setup_dynamic_payload . . . .  PUBLIC   CODE   PROC     0000H  -----
  setup. . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  dynpd. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
_hal_nrf_write_reg . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  reg. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  value. . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
  retval . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
IEN1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
hal_nrf_get_fifo_status. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_PWR_DOWN . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_CRC_OFF. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_get_pipe_status . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  en_rxaddr. . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
  en_aa. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
  en_rx_r. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0003H  1
  en_aa_r. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
HAL_NRF_RX_DR. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_get_rx_payload_width. . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  pw . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
hal_nrf_get_irq_flags. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_ACK_PLOAD. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 68  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


HAL_NRF_TX_DS. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_set_power_mode. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pwr_mode . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
setup_retr_t . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
_hal_nrf_rw. . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
HAL_NRF_TX . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_get_carrier_detect . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_rx_payload_width. . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  pload_width. . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
en_pipes_t . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
hal_nrf_get_packet_lost_ctr. . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_crc_mode. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  crc_mode . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
hal_nrf_flush_rx . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_flush_tx . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_get_transmit_attempts. . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_AW_3BYTES. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_reuse_tx . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_output_power. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  power. . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
HAL_NRF_AW_4BYTES. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
HAL_NRF_AW_5BYTES. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_12DBM. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_set_datarate. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  datarate . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
HAL_NRF_18DBM. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_set_pll_mode. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pll_lock . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
hal_nrf_get_rx_data_source . . . . . .  PUBLIC   CODE   PROC     0000H  -----
rf_setup_t . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
setup_aw_t . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
_hal_nrf_set_irq_mode. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  int_source . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  irq_state. . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
_hal_nrf_read_multibyte_reg. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  reg. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  pbuf . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  1
  ctr. . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
  length . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0001H  1
hal_nrf_rx_fifo_empty. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_enable_dynamic_payload. . . .  PUBLIC   CODE   PROC     0000H  -----
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 69  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  feature. . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
feature_t. . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
hal_nrf_tx_fifo_empty. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_get_auto_retr_status . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_rx_fifo_full . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_250KBPS. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_tx_fifo_full . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_auto_retr . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  retr . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0003H  1
  delay. . . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0004H  2
  setup_retr . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
_hal_nrf_get_address . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  address. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  addr . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
RFSPIF . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C0H  1
USBCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
_hal_nrf_set_operation_mode. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  op_mode. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
config_t . . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
_hal_nrf_write_ack_payload . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  tx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0005H  1
  length . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0003H  1
HAL_NRF_CRC_8BIT . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
uint8_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
hal_nrf_get_address_width. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_write_multibyte_reg . . . . .  STATIC   CODE   PROC     0000H  -----
  cmd. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  pbuf . . . . . . . . . . . . . . . .  * REG *  DATA   PTR      0000H  1
  length . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0003H  1
  dummy. . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
hal_nrf_crc_mode_t . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_ALL. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_irq_source_t . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_set_address . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  address. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  addr . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
rf_ch_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
int8_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
hal_nrf_output_power_t . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
hal_nrf_activate_features. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_get_rx_fifo_status . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_address_width . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  aw . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  setup_aw . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
HAL_NRF_PIPE0. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_get_tx_fifo_status . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_PIPE1. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_get_reuse_tx_status. . . . . .  PUBLIC   CODE   PROC     0000H  -----
C51 COMPILER V9.02   HAL_NRF                                                               05/15/2011 19:16:12 PAGE 70  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


HAL_NRF_PIPE2. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_datarate_t . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_PIPE3. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_PIPE4. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_PIPE5. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_1MBPS. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_2MBPS. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
S0CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
T2CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
_hal_nrf_close_pipe. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  en_rxaddr. . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
  en_aa. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
FSR. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F8H  1
hal_nrf_pload_command_t. . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_MAX_RT . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_Bool. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
AESCS. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
RFDAT. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E5H  1
_hal_nrf_enable_continious_wave. . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
hal_nrf_operation_mode_t . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_clear_irq_flag. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  int_source . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
hal_nrf_pwr_mode_t . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_read_rx_payload . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  rx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0007H  1
HAL_NRF_PRX. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
RFCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0090H  1
_hal_nrf_write_tx_payload_noack. . . .  PUBLIC   CODE   PROC     0000H  -----
  tx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0007H  1
  length . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0006H  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
HAL_NRF_RX_PLOAD . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_PTX. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_read_rx_payload_width. . . . .  PUBLIC   CODE   PROC     0000H  -----
WDCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
IRCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1
HAL_NRF_TX_PLOAD . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
uint32_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
_hal_nrf_read_reg. . . . . . . . . . .  STATIC   CODE   PROC     0004H  -----
  reg. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  temp . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
RFCSN. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0091H  1
HAL_NRF_PWR_UP . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1835    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      50
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
